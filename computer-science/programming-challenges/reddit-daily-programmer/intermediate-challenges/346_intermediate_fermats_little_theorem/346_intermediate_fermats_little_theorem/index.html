<!doctype html><html lang=en><head><title>Fermat's Little Theorem (Intermediate) | curiosities.dev</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo (https://gohugo.io/)"><meta name=description content="Description  Link to original challenge   Most introductionary implementations for testing the primality of a number have a time complexity of $ O(\sqrt{n}) $. For large numbers this is not a feasible strategy, for example testing a 400 digit number   . Fermat&rsquo;s Little Theorem states:
 If $p$ is a prime number, then for any integer $a$, the number $a^p − a$ is an integer multiple of $p$..."><link rel=stylesheet type=text/css href=/css/main.min.css><link rel=preload href=/css/all_font_awesome_v5.9.min.min.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=/css/all_font_awesome_v5.9.min.min.css></noscript><link rel="shortcut icon" href=/img/favicon_io/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/img/favicon_io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/img/favicon_io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/img/favicon_io/favicon-16x16.png><script async type=text/javascript src=/js/OrganizeCitations.min.js></script><script async type=text/javascript src=/js/HighlightAnchor.min.js></script><script async type=text/javascript src=/js/SummaryPageUtils.min.js></script></head><svg id="background-svg"/><body><div class=container id=main_div><form action=/search method=get id=globalSearchForm><input type=text id=q name=q title="Search Query">
<input type=submit id=submitButton value=Search></form><nav aria-label=Breadcrumb class=breadcrumb><ul><li><a href=https://www.curiosities.dev/>Home</a></li><li><a href=https://www.curiosities.dev/computer-science/>Computer Science & Software Engineering</a></li><li><a href=https://www.curiosities.dev/computer-science/programming-challenges/>Programming Challenges</a></li><li><a href=https://www.curiosities.dev/computer-science/programming-challenges/reddit-daily-programmer/>Reddit Daily Programmer</a></li><li><a href=https://www.curiosities.dev/computer-science/programming-challenges/reddit-daily-programmer/intermediate-challenges/>Intermediate Challenges</a></li><li class=active><a href=https://www.curiosities.dev/computer-science/programming-challenges/reddit-daily-programmer/intermediate-challenges/346_intermediate_fermats_little_theorem/346_intermediate_fermats_little_theorem/>Fermat's Little Theorem (Intermediate)</a></li></ul></nav><section><header><h1>Fermat's Little Theorem (Intermediate)</h1><p class=meta>Dated Jan 26, 2018;
last modified on Fri, 26 Jan 2018</p></header><div id=toc-then-article><aside id=toc><nav id=TableOfContents><ul><li><a href=#description>Description</a><ul><li><a href=#my-solution>My Solution</a></li><li><a href=#bonus-challenge>Bonus Challenge</a></li><li><a href=#futher-reading>Futher reading</a></li></ul></li></ul></nav></aside><article id=main-article><h2 id=description>Description</h2><p><a href=https://www.reddit.com/r/dailyprogrammer/comments/7pmt9c/20180110_challenge_346_intermediate_fermats/ target=_blank rel=noopener>Link to original challenge
<i class="fas fa-fw fa-external-link-alt" aria-hidden=true></i></a></p><p>Most introductionary implementations for testing the primality of a number have a time complexity of $ O(\sqrt{n}) $. For large numbers this is not a feasible strategy, for example testing a
<a href=https://en.wikipedia.org/wiki/Largest_known_prime_number target=_blank rel=noopener>400 digit number
<i class="fas fa-fw fa-external-link-alt" aria-hidden=true></i></a>. Fermat&rsquo;s Little Theorem states:</p><blockquote><p>If $p$ is a prime number, then for any integer $a$, the number $a^p − a$ is an integer multiple of $p$</p></blockquote><p>This can also be stated as: $a^p \mod p = a$. If $n$ is not prime, then, in general, most of the numbers $a &lt; n$ will not satisfy the above relation. This leads to the following algorithm for testing primality:</p><ul><li>Given a number $n$, pick a random number $a &lt; n$ and compute the remainder of $a^n \mod n$.</li><li>If the result is not equal to $a$, then $n$ is certainly not prime. If it is $a$, then chances are good that $n$ is prime.</li><li>Now pick another random number $a$ and test it with the same method. If it also satisfies the equation, then we can be even more confident that $n$ is prime.</li></ul><p>By trying more and more values of $a$, we can increase our confidence in the result. This algorithm is known as the Fermat test.</p><ul><li>If $n$ passes the test for some random choice of $a$, the chances are better than even that $n$ is prime.</li><li>If $n$ passes the test for two random choices of $a$, the chances are better than 3 out of 4 that $n$ is prime.</li></ul><p>By running the test with more and more randomly chosen values of a we can make the probability of error as small as we like. Create a program to do Fermat&rsquo;s test on a number, given a required certainty. Let the power of the modulo guide you.</p><h3 id=my-solution>My Solution</h3><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=color:#111>{</span><span style=color:#f92672>%</span> <span style=color:#111>include_relative</span> <span style=color:#ae81ff>346</span><span style=color:#111>_intermediate_fermats_little_theorem</span><span style=color:#f92672>/</span><span style=color:#111>primality_test</span><span style=color:#f92672>.</span><span style=color:#111>py</span> <span style=color:#f92672>%</span><span style=color:#111>}</span>
</code></pre></div><h3 id=bonus-challenge>Bonus Challenge</h3><p>There do exist numbers that fool the Fermat test: numbers $n$ that are not prime and yet have the property that $a^n$ is congruent to a modulo $n$ for all integers $a &lt; n$. Such numbers are extremely rare, so the Fermat test is quite reliable in practice. Numbers that fool the Fermat test are called Carmichael numbers, and little is known about them other than that they are extremely rare. There are $255$ Carmichael numbers below $100,000,000$.</p><p>There are variants of the Fermat test that cannot be fooled by these. Implement one.</p><h3 id=futher-reading>Futher reading</h3><ul><li><a href=https://mitpress.mit.edu/sicp/chapter1/node17.html target=_blank rel=noopener>SICP 1.2.6 (Testing for Primality)
<i class="fas fa-fw fa-external-link-alt" aria-hidden=true></i></a></li><li><a href=http://mathworld.wolfram.com/topics/PrimalityTesting.html target=_blank rel=noopener>Wolfram MathWorld: Primality Testing
<i class="fas fa-fw fa-external-link-alt" aria-hidden=true></i></a></li><li><a href=https://en.wikipedia.org/wiki/Modular_exponentiation target=_blank rel=noopener>Wiki Modular exponentiation
<i class="fas fa-fw fa-external-link-alt" aria-hidden=true></i></a></li></ul></article><div style=font-size:smaller></div></div><footer><a href=https://www.curiosities.dev/computer-science/programming-challenges/reddit-daily-programmer/intermediate-challenges/347_intermediate_linear_feedback_shift_register/347_intermediate_linear_feedback_shift_register/>&#171; Linear Feedback Shift Register (Intermediate)</a>
<a href=https://www.curiosities.dev/computer-science/programming-challenges/reddit-daily-programmer/intermediate-challenges/380_intermediate_smooshed_morse_code/380_intermediate_smooshed_morse_code/>Smooshed Morse Code (Intermediate) &#187;</a></footer></section></div><footer><a href=mailto:d.chege711@gmail.com>Email</a>
<a href=/about>About</a>
<a href=/search>Search</a></footer></body></html>