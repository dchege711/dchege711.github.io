<!doctype html><html lang=en><head><title>Shortest Path in a Grid w/ Obstacles Elimination | curiosities.dev</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo (https://gohugo.io/)"><meta name=description content="Shortest Path in a Grid with Obstacles Elimination - LeetCode.  leetcode.com  .  Accessed Jul 21, 2024.  Problem You are given an \(m \times n\) grid where each cell is either 0 (empty) or 1 (obstacle). You can move up, down, left, or right from and to an empty cell in one step.
Return the minimum number of steps to walk from the upper left corner \((0, 0)\) to the lower-right corner \((m-1, n-1)\) given that you can eliminate at most \(k\) obstacles...."><meta property="og:title" content="Shortest Path in a Grid w/ Obstacles Elimination"><meta property="og:description" content="Shortest Path in a Grid with Obstacles Elimination - LeetCode.  leetcode.com  .  Accessed Jul 21, 2024.  Problem You are given an \(m \times n\) grid where each cell is either 0 (empty) or 1 (obstacle). You can move up, down, left, or right from and to an empty cell in one step.
Return the minimum number of steps to walk from the upper left corner \((0, 0)\) to the lower-right corner \((m-1, n-1)\) given that you can eliminate at most \(k\) obstacles...."><meta property="og:type" content="website"><meta property="og:url" content="https://www.curiosities.dev/computer-science/programming-challenges/leet-code-and-others/grids/shortest-path-in-grid-with-obstacles-elimination/"><meta property="og:site_name" content="curiosities.dev"><link rel=stylesheet type=text/css href=/css/main.min.css><link rel=preload href=/css/all_font_awesome_v5.9.min.min.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=/css/all_font_awesome_v5.9.min.min.css></noscript><link rel="shortcut icon" href=/img/favicon_io/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/img/favicon_io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/img/favicon_io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/img/favicon_io/favicon-16x16.png><script async type=text/javascript src=/js/OrganizeCitations.min.js></script><script async type=text/javascript src=/js/HighlightAnchor.min.js></script><script async type=text/javascript src=/js/SummaryPageUtils.min.js></script><link rel=preload href=/css/vs.min.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=/css/vs.min.css></noscript><script defer type=text/javascript src=/js/highlight.min.min.js onload=addURLHighlighter();></script><script defer>const hjlsURLRegex=/https?:\/\/[^\s<]+/g
const hjlsCitationRegex=/&lt;span class=&quot;citation-ref&quot;&gt;&lt;a href=&quot;(.*)&quot;&gt;&lt;\/a&gt;&lt;\/span&gt;/g
function addURLHighlighter(){hljs.addPlugin({"after:highlight":(result)=>{result.value=result.value.replaceAll(hjlsURLRegex,"<a href='$&' target='_blank'>$&</a>");console.log(result.value);result.value=result.value.replaceAll(hjlsCitationRegex,"<span class='citation-ref'><a href='$1'></a></span>");}});hljs.highlightAll();}</script><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script></head><body><div class=container id=main_div><form action=/search method=get id=globalSearchForm><input type=text id=q name=q title="Search Query">
<input type=submit id=submitButton value=Search></form><nav aria-label=Breadcrumb class=breadcrumb><ul><li><a href=https://www.curiosities.dev/>Home</a></li><li><a href=https://www.curiosities.dev/computer-science/>Computer Science & Software Engineering</a></li><li><a href=https://www.curiosities.dev/computer-science/programming-challenges/>Programming Challenges</a></li><li><a href=https://www.curiosities.dev/computer-science/programming-challenges/leet-code-and-others/>Leet Code Style Questions</a></li><li><a href=https://www.curiosities.dev/computer-science/programming-challenges/leet-code-and-others/grids/>Grids</a></li><li class=active><a href=https://www.curiosities.dev/computer-science/programming-challenges/leet-code-and-others/grids/shortest-path-in-grid-with-obstacles-elimination/>Shortest Path in a Grid w/ Obstacles Elimination</a></li></ul></nav><section><header><h1>Shortest Path in a Grid w/ Obstacles Elimination</h1><p class=meta>Dated Jul 21, 2024;
last modified on Sun, 21 Jul 2024</p></header><div id=toc-then-article><aside id=toc><nav id=TableOfContents><ul><li><a href=#problem>Problem</a></li><li><a href=#solution>Solution</a></li><li><a href=#learnings-from-others-solutions>Learnings from Others' Solutions</a></li><li><a href=#references>References</a></li></ul></nav></aside><article id=main-article><div class=citation citation-icon-class="fas fa-fw fa-globe" cited-by-count is-main><cite id=leetCode1293>Shortest Path in a Grid with Obstacles Elimination - LeetCode<i>.</i></cite>
<a href=https://leetcode.com/problems/shortest-path-in-a-grid-with-obstacles-elimination/ target=_blank rel=noopener><img src="https://www.google.com/s2/favicons?domain=leetcode.com" loading=lazy aria-hidden=true width=16 height=16>
<i>leetcode.com</i> <i class="fas fa-fw fa-external-link-alt" aria-hidden=true></i></a>.
<i class="fas fa-fw fa-globe" aria-hidden=true></i>Accessed Jul 21, 2024.</div><h2 id=problem>Problem</h2><p>You are given an \(m \times n\) <code>grid</code> where each cell is either <code>0</code>
(empty) or <code>1</code> (obstacle). You can move up, down, left, or right from
and to an empty cell in one step.</p><p>Return the minimum number of steps to walk from the upper left corner
\((0, 0)\) to the lower-right corner \((m-1, n-1)\) given that you
can eliminate at most \(k\) obstacles. If it is not possible to find
such a walk, return <code>-1</code>.</p><figure><img src=/img/computer-science/programming-challenges/leet-code-and-others/grids/shortest-path-w-obstacle-elimination/5x3-grid.jpg alt="\([[0,0,0],[1,1,0],[0,0,0],[0,1,1],[0,0,0]]\) with \(k=1\). The shortest path with one obstacle elimination at position \((3, 2)\) is 6."><figcaption><p>\([[0,0,0],[1,1,0],[0,0,0],[0,1,1],[0,0,0]]\) with \(k=1\). The shortest path with one obstacle elimination at position \((3, 2)\) is 6.</p></figcaption></figure><p>Constraints:</p><ul><li><code>m == grid.length</code></li><li><code>n == grid[i].length</code></li><li>\(1 \le m, n \le 40\)</li><li>\(1 \le k \le mn \)</li><li><code>grid[i][j]</code> is either <code>0</code> or <code>1</code>.</li><li><code>grid[0][0] == grid[m - 1][n - 1] == 0</code></li></ul><h2 id=solution>Solution</h2><p>Can I model this as a dynamic programming (DP) problem? The shortest
path to <code>grid[r][c]</code> is the \(1\) plus shortest path to any of the 4
ways at getting to <code>grid[r][c]</code>.</p><details><summary>DP attempt</summary><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-py data-lang=py><span style=color:#00a8c8>def</span> <span style=color:#75af00>shortest_path_in_grid_with_obstacles_elimination</span><span style=color:#111>(</span><span style=color:#111>grid</span><span style=color:#111>:</span> <span style=color:#111>List</span><span style=color:#111>[</span><span style=color:#111>List</span><span style=color:#111>[</span><span style=color:#111>int</span><span style=color:#111>]],</span> <span style=color:#111>K</span><span style=color:#111>:</span> <span style=color:#111>int</span><span style=color:#111>)</span> <span style=color:#f92672>-&gt;</span> <span style=color:#111>int</span><span style=color:#111>:</span>
    <span style=color:#111>R</span> <span style=color:#f92672>=</span> <span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>grid</span><span style=color:#111>)</span>
    <span style=color:#00a8c8>assert</span> <span style=color:#111>R</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;There should be at least one row&#34;</span>

    <span style=color:#111>C</span> <span style=color:#f92672>=</span> <span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>])</span>
    <span style=color:#00a8c8>assert</span> <span style=color:#111>all</span><span style=color:#111>(</span><span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>row</span><span style=color:#111>)</span> <span style=color:#f92672>==</span> <span style=color:#111>C</span> <span style=color:#00a8c8>for</span> <span style=color:#111>row</span> <span style=color:#f92672>in</span> <span style=color:#111>grid</span><span style=color:#111>),</span> <span style=color:#111>f</span><span style=color:#d88200>&#34;All rows should have {C} columns&#34;</span>

    <span style=color:#00a8c8>assert</span> <span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>][</span><span style=color:#ae81ff>0</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;(0, 0) should not have an obstacle&#34;</span>
    <span style=color:#00a8c8>assert</span> <span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#111>R</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>][</span><span style=color:#111>C</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;Destination should not have an obstacle&#34;</span>

    <span style=color:#111>possible_steps</span> <span style=color:#f92672>=</span> <span style=color:#111>[</span><span style=color:#111>Step</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>),</span> <span style=color:#111>Step</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>1</span><span style=color:#111>),</span> <span style=color:#111>Step</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>),</span> <span style=color:#111>Step</span><span style=color:#111>(</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>)]</span>

    <span style=color:#00a8c8>def</span> <span style=color:#75af00>in_range</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>):</span>
        <span style=color:#00a8c8>return</span> <span style=color:#111>r</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>and</span> <span style=color:#111>c</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>and</span> <span style=color:#111>r</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>R</span> <span style=color:#f92672>and</span> <span style=color:#111>c</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>C</span>

    <span style=color:#00a8c8>def</span> <span style=color:#75af00>fewest_steps_to_point</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>:</span> <span style=color:#111>int</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>:</span> <span style=color:#111>int</span><span style=color:#111>,</span> <span style=color:#111>k</span><span style=color:#111>:</span> <span style=color:#111>int</span><span style=color:#111>,</span> <span style=color:#111>visited</span><span style=color:#111>:</span> <span style=color:#111>set</span><span style=color:#111>):</span>
        <span style=color:#00a8c8>assert</span> <span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>)</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> <span style=color:#111>visited</span><span style=color:#111>,</span> <span style=color:#111>f</span><span style=color:#d88200>&#34;Should not revisit ({r}, {c})&#34;</span>
        <span style=color:#111>visited</span><span style=color:#f92672>.</span><span style=color:#111>add</span><span style=color:#111>((</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>))</span>

        <span style=color:#75715e># We start from (0, 0). No steps needed to get here.</span>
        <span style=color:#00a8c8>if</span> <span style=color:#111>r</span> <span style=color:#f92672>==</span> <span style=color:#111>c</span> <span style=color:#f92672>and</span> <span style=color:#111>c</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#111>:</span>
            <span style=color:#00a8c8>return</span> <span style=color:#ae81ff>0</span>

        <span style=color:#75715e># If it&#39;s impossible to get here, return `inf`.</span>
        <span style=color:#00a8c8>if</span> <span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#111>r</span><span style=color:#111>][</span><span style=color:#111>c</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>and</span> <span style=color:#111>k</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span><span style=color:#111>:</span>
            <span style=color:#00a8c8>return</span> <span style=color:#111>inf</span>

        <span style=color:#75715e># Consider all the ways that we could have gotten to (r, c). Pick the</span>
        <span style=color:#75715e># one with the fewest number of steps</span>
        <span style=color:#111>fewest_steps</span> <span style=color:#f92672>=</span> <span style=color:#111>inf</span>
        <span style=color:#00a8c8>for</span> <span style=color:#111>dr</span><span style=color:#111>,</span> <span style=color:#111>dc</span> <span style=color:#f92672>in</span> <span style=color:#111>possible_steps</span><span style=color:#111>:</span>
            <span style=color:#111>new_r</span><span style=color:#111>,</span> <span style=color:#111>new_c</span> <span style=color:#f92672>=</span> <span style=color:#111>r</span> <span style=color:#f92672>+</span> <span style=color:#111>dr</span><span style=color:#111>,</span> <span style=color:#111>c</span> <span style=color:#f92672>+</span> <span style=color:#111>dc</span>
            <span style=color:#00a8c8>if</span> <span style=color:#f92672>not</span> <span style=color:#111>in_range</span><span style=color:#111>(</span><span style=color:#111>new_r</span><span style=color:#111>,</span> <span style=color:#111>new_c</span><span style=color:#111>):</span>
                <span style=color:#00a8c8>continue</span>

            <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>new_r</span><span style=color:#111>,</span> <span style=color:#111>new_c</span><span style=color:#111>)</span> <span style=color:#f92672>in</span> <span style=color:#111>visited</span><span style=color:#111>:</span>
                <span style=color:#00a8c8>continue</span>

            <span style=color:#111>is_empty_cell</span> <span style=color:#f92672>=</span> <span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#111>new_r</span><span style=color:#111>][</span><span style=color:#111>new_c</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>
            <span style=color:#111>steps</span> <span style=color:#f92672>=</span> <span style=color:#111>fewest_steps_to_point</span><span style=color:#111>(</span>
                <span style=color:#111>new_r</span><span style=color:#111>,</span> <span style=color:#111>new_c</span><span style=color:#111>,</span> <span style=color:#111>k</span> <span style=color:#00a8c8>if</span> <span style=color:#111>is_empty_cell</span> <span style=color:#00a8c8>else</span> <span style=color:#111>k</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>visited</span>
            <span style=color:#111>)</span>

            <span style=color:#00a8c8>if</span> <span style=color:#111>steps</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>fewest_steps</span><span style=color:#111>:</span>
                <span style=color:#111>fewest_steps</span> <span style=color:#f92672>=</span> <span style=color:#111>steps</span>

        <span style=color:#00a8c8>return</span> <span style=color:#111>fewest_steps</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>

    <span style=color:#111>fewest_steps_to_dest</span> <span style=color:#f92672>=</span> <span style=color:#111>fewest_steps_to_point</span><span style=color:#111>(</span><span style=color:#111>R</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>C</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>K</span><span style=color:#111>,</span> <span style=color:#111>set</span><span style=color:#111>())</span>
    <span style=color:#00a8c8>return</span> <span style=color:#111>fewest_steps_to_dest</span> <span style=color:#00a8c8>if</span> <span style=color:#111>fewest_steps_to_dest</span> <span style=color:#f92672>!=</span> <span style=color:#111>inf</span> <span style=color:#00a8c8>else</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</code></pre></div></details><p>But this ignores the fact that the shortest path to <code>grid[r][c]</code> might
have used up \(k\). A longer path might have conserved \(k\) and
used it to create a better shortcut further down.</p><p>What about modeling it as a depth-first-search (DFS) problem? Let the
<code>dfs</code> succeed if it gets to <code>grid[m -1][n - 1]</code>. When collecting the
<code>dfs</code> results, discard the longer path. That way, \(k\) is implicitly
taken care of because a successful <code>dfs</code> must have reached the <code>grid[m -1][n - 1]</code>, and we don&rsquo;t need to minimize \(k\).</p><details><summary>DFS attempt that returns a path, not necessarily the shortest one</summary><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-py data-lang=py><span style=color:#00a8c8>def</span> <span style=color:#75af00>shortest_path_in_grid_with_obstacles_elimination</span><span style=color:#111>(</span><span style=color:#111>grid</span><span style=color:#111>:</span> <span style=color:#111>List</span><span style=color:#111>[</span><span style=color:#111>List</span><span style=color:#111>[</span><span style=color:#111>int</span><span style=color:#111>]],</span> <span style=color:#111>K</span><span style=color:#111>:</span> <span style=color:#111>int</span><span style=color:#111>)</span> <span style=color:#f92672>-&gt;</span> <span style=color:#111>int</span><span style=color:#111>:</span>
    <span style=color:#111>R</span> <span style=color:#f92672>=</span> <span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>grid</span><span style=color:#111>)</span>
    <span style=color:#00a8c8>assert</span> <span style=color:#111>R</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;There should be at least one row&#34;</span>

    <span style=color:#111>C</span> <span style=color:#f92672>=</span> <span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>])</span>
    <span style=color:#00a8c8>assert</span> <span style=color:#111>all</span><span style=color:#111>(</span><span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>row</span><span style=color:#111>)</span> <span style=color:#f92672>==</span> <span style=color:#111>C</span> <span style=color:#00a8c8>for</span> <span style=color:#111>row</span> <span style=color:#f92672>in</span> <span style=color:#111>grid</span><span style=color:#111>),</span> <span style=color:#111>f</span><span style=color:#d88200>&#34;All rows should have {C} columns&#34;</span>

    <span style=color:#00a8c8>assert</span> <span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>][</span><span style=color:#ae81ff>0</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;(0, 0) should not have an obstacle&#34;</span>
    <span style=color:#00a8c8>assert</span> <span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#111>R</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>][</span><span style=color:#111>C</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;Destination should not have an obstacle&#34;</span>

    <span style=color:#111>possible_steps</span> <span style=color:#f92672>=</span> <span style=color:#111>[</span><span style=color:#111>Step</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>),</span> <span style=color:#111>Step</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>1</span><span style=color:#111>),</span> <span style=color:#111>Step</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>),</span> <span style=color:#111>Step</span><span style=color:#111>(</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>)]</span>

    <span style=color:#00a8c8>def</span> <span style=color:#75af00>in_range</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>):</span>
        <span style=color:#00a8c8>return</span> <span style=color:#111>r</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>and</span> <span style=color:#111>c</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>and</span> <span style=color:#111>r</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>R</span> <span style=color:#f92672>and</span> <span style=color:#111>c</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>C</span>

    <span style=color:#00a8c8>def</span> <span style=color:#75af00>has_obstacle</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>):</span>
        <span style=color:#00a8c8>return</span> <span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#111>r</span><span style=color:#111>][</span><span style=color:#111>c</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>

    <span style=color:#00a8c8>def</span> <span style=color:#75af00>dfs</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>:</span> <span style=color:#111>int</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>:</span> <span style=color:#111>int</span><span style=color:#111>,</span> <span style=color:#111>k</span><span style=color:#111>:</span> <span style=color:#111>int</span><span style=color:#111>,</span> <span style=color:#111>visited</span><span style=color:#111>:</span> <span style=color:#111>set</span><span style=color:#111>):</span>
        <span style=color:#00a8c8>assert</span> <span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>)</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> <span style=color:#111>visited</span><span style=color:#111>,</span> <span style=color:#111>f</span><span style=color:#d88200>&#34;Should not revisit ({r}, {c})&#34;</span>
        <span style=color:#111>visited</span><span style=color:#f92672>.</span><span style=color:#111>add</span><span style=color:#111>((</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>))</span>

        <span style=color:#75715e># If we&#39;ve gotten to the destination, return zero. The path length will</span>
        <span style=color:#75715e># be computed as the DFS returns.</span>
        <span style=color:#00a8c8>if</span> <span style=color:#111>r</span> <span style=color:#f92672>==</span> <span style=color:#111>R</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>and</span> <span style=color:#111>c</span> <span style=color:#f92672>==</span> <span style=color:#111>C</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>:</span>
            <span style=color:#00a8c8>return</span> <span style=color:#ae81ff>0</span>

        <span style=color:#75715e># Advance the DFS in all possible unvisited directions</span>
        <span style=color:#111>fewest_steps</span> <span style=color:#f92672>=</span> <span style=color:#111>inf</span>
        <span style=color:#00a8c8>for</span> <span style=color:#111>dr</span><span style=color:#111>,</span> <span style=color:#111>dc</span> <span style=color:#f92672>in</span> <span style=color:#111>possible_steps</span><span style=color:#111>:</span>
            <span style=color:#111>new_r</span><span style=color:#111>,</span> <span style=color:#111>new_c</span> <span style=color:#f92672>=</span> <span style=color:#111>r</span> <span style=color:#f92672>+</span> <span style=color:#111>dr</span><span style=color:#111>,</span> <span style=color:#111>c</span> <span style=color:#f92672>+</span> <span style=color:#111>dc</span>

            <span style=color:#00a8c8>if</span> <span style=color:#f92672>not</span> <span style=color:#111>in_range</span><span style=color:#111>(</span><span style=color:#111>new_r</span><span style=color:#111>,</span> <span style=color:#111>new_c</span><span style=color:#111>):</span> <span style=color:#00a8c8>continue</span>
            <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>new_r</span><span style=color:#111>,</span> <span style=color:#111>new_c</span><span style=color:#111>)</span> <span style=color:#f92672>in</span> <span style=color:#111>visited</span><span style=color:#111>:</span> <span style=color:#00a8c8>continue</span>

            <span style=color:#111>new_k</span> <span style=color:#f92672>=</span> <span style=color:#111>k</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span> <span style=color:#00a8c8>if</span> <span style=color:#111>has_obstacle</span><span style=color:#111>(</span><span style=color:#111>new_r</span><span style=color:#111>,</span> <span style=color:#111>new_c</span><span style=color:#111>)</span> <span style=color:#00a8c8>else</span> <span style=color:#111>k</span>
            <span style=color:#00a8c8>if</span> <span style=color:#111>new_k</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span><span style=color:#111>:</span> <span style=color:#00a8c8>continue</span>

            <span style=color:#111>steps</span> <span style=color:#f92672>=</span> <span style=color:#111>dfs</span><span style=color:#111>(</span><span style=color:#111>new_r</span><span style=color:#111>,</span> <span style=color:#111>new_c</span><span style=color:#111>,</span> <span style=color:#111>new_k</span><span style=color:#111>,</span> <span style=color:#111>visited</span><span style=color:#111>,</span> <span style=color:#111>depth</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#111>)</span>
            <span style=color:#111>fewest_steps</span> <span style=color:#f92672>=</span> <span style=color:#111>min</span><span style=color:#111>(</span><span style=color:#111>steps</span><span style=color:#111>,</span> <span style=color:#111>fewest_steps</span><span style=color:#111>)</span>

        <span style=color:#00a8c8>return</span> <span style=color:#111>fewest_steps</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>

    <span style=color:#111>fewest_steps_to_dest</span> <span style=color:#f92672>=</span> <span style=color:#111>dfs</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#111>K</span><span style=color:#111>,</span> <span style=color:#111>set</span><span style=color:#111>(),</span> <span style=color:#ae81ff>0</span><span style=color:#111>)</span>
    <span style=color:#00a8c8>return</span> <span style=color:#111>fewest_steps_to_dest</span> <span style=color:#00a8c8>if</span> <span style=color:#111>fewest_steps_to_dest</span> <span style=color:#f92672>!=</span> <span style=color:#111>inf</span> <span style=color:#00a8c8>else</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</code></pre></div></details><p>While I can find <em>a</em> path, the above doesn&rsquo;t give me the shortest path.
Breadth-first-search (BFS) should give me the shortest path from \((0,
0)\) to \((m-1, n-1)\).</p><details><summary>BFS implementation that exceeds the time limit</summary><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-py data-lang=py><span style=color:#00a8c8>def</span> <span style=color:#75af00>shortest_path_in_grid_with_obstacles_elimination</span><span style=color:#111>(</span>
    <span style=color:#111>grid</span><span style=color:#111>:</span> <span style=color:#111>List</span><span style=color:#111>[</span><span style=color:#111>List</span><span style=color:#111>[</span><span style=color:#111>int</span><span style=color:#111>]],</span> <span style=color:#111>K</span><span style=color:#111>:</span> <span style=color:#111>int</span>
<span style=color:#111>)</span> <span style=color:#f92672>-&gt;</span> <span style=color:#111>int</span><span style=color:#111>:</span>
    <span style=color:#111>R</span> <span style=color:#f92672>=</span> <span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>grid</span><span style=color:#111>)</span>
    <span style=color:#00a8c8>assert</span> <span style=color:#111>R</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;There should be at least one row&#34;</span>

    <span style=color:#111>C</span> <span style=color:#f92672>=</span> <span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>])</span>
    <span style=color:#00a8c8>assert</span> <span style=color:#111>all</span><span style=color:#111>(</span><span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>row</span><span style=color:#111>)</span> <span style=color:#f92672>==</span> <span style=color:#111>C</span> <span style=color:#00a8c8>for</span> <span style=color:#111>row</span> <span style=color:#f92672>in</span> <span style=color:#111>grid</span><span style=color:#111>),</span> <span style=color:#111>f</span><span style=color:#d88200>&#34;All rows should have {C} columns&#34;</span>

    <span style=color:#00a8c8>assert</span> <span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>][</span><span style=color:#ae81ff>0</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;(0, 0) should not have an obstacle&#34;</span>
    <span style=color:#00a8c8>assert</span> <span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#111>R</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>][</span><span style=color:#111>C</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;Destination should not have an obstacle&#34;</span>

    <span style=color:#111>possible_steps</span> <span style=color:#f92672>=</span> <span style=color:#111>[</span><span style=color:#111>Step</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>),</span> <span style=color:#111>Step</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>1</span><span style=color:#111>),</span> <span style=color:#111>Step</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>),</span> <span style=color:#111>Step</span><span style=color:#111>(</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>)]</span>

    <span style=color:#00a8c8>def</span> <span style=color:#75af00>in_range</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>):</span>
        <span style=color:#00a8c8>return</span> <span style=color:#111>r</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>and</span> <span style=color:#111>c</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>and</span> <span style=color:#111>r</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>R</span> <span style=color:#f92672>and</span> <span style=color:#111>c</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>C</span>

    <span style=color:#00a8c8>def</span> <span style=color:#75af00>has_obstacle</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>):</span>
        <span style=color:#00a8c8>return</span> <span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#111>r</span><span style=color:#111>][</span><span style=color:#111>c</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>

    <span style=color:#00a8c8>def</span> <span style=color:#75af00>bfs</span><span style=color:#111>():</span>
        <span style=color:#111>cells_to_visit</span><span style=color:#111>:</span> <span style=color:#111>List</span><span style=color:#111>[</span><span style=color:#111>Tuple</span><span style=color:#111>[</span><span style=color:#111>int</span><span style=color:#111>,</span> <span style=color:#111>Tuple</span><span style=color:#111>[</span><span style=color:#111>int</span><span style=color:#111>,</span> <span style=color:#111>int</span><span style=color:#111>,</span> <span style=color:#111>int</span><span style=color:#111>]]]</span> <span style=color:#f92672>=</span> <span style=color:#111>[]</span>
        <span style=color:#111>heappush</span><span style=color:#111>(</span><span style=color:#111>cells_to_visit</span><span style=color:#111>,</span> <span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#111>K</span><span style=color:#111>)))</span>
        <span style=color:#111>visited</span> <span style=color:#f92672>=</span> <span style=color:#111>set</span><span style=color:#111>()</span>

        <span style=color:#00a8c8>while</span> <span style=color:#111>cells_to_visit</span><span style=color:#111>:</span>
            <span style=color:#111>num_steps</span><span style=color:#111>,</span> <span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>,</span> <span style=color:#111>k</span><span style=color:#111>)</span> <span style=color:#f92672>=</span> <span style=color:#111>heappop</span><span style=color:#111>(</span><span style=color:#111>cells_to_visit</span><span style=color:#111>)</span>
            <span style=color:#111>visited</span><span style=color:#f92672>.</span><span style=color:#111>add</span><span style=color:#111>((</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>))</span>

            <span style=color:#75715e># We&#39;ve gotten to the dest. BFS ensures minimal cost.</span>
            <span style=color:#00a8c8>if</span> <span style=color:#111>r</span> <span style=color:#f92672>==</span> <span style=color:#111>R</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>and</span> <span style=color:#111>c</span> <span style=color:#f92672>==</span> <span style=color:#111>C</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>:</span> <span style=color:#00a8c8>return</span> <span style=color:#111>num_steps</span>

            <span style=color:#00a8c8>for</span> <span style=color:#111>dr</span><span style=color:#111>,</span> <span style=color:#111>dc</span> <span style=color:#f92672>in</span> <span style=color:#111>possible_steps</span><span style=color:#111>:</span>
                <span style=color:#111>next_r</span><span style=color:#111>,</span> <span style=color:#111>next_c</span> <span style=color:#f92672>=</span> <span style=color:#111>r</span> <span style=color:#f92672>+</span> <span style=color:#111>dr</span><span style=color:#111>,</span> <span style=color:#111>c</span> <span style=color:#f92672>+</span> <span style=color:#111>dc</span>

                <span style=color:#00a8c8>if</span> <span style=color:#f92672>not</span> <span style=color:#111>in_range</span><span style=color:#111>(</span><span style=color:#111>next_r</span><span style=color:#111>,</span> <span style=color:#111>next_c</span><span style=color:#111>):</span> <span style=color:#00a8c8>continue</span>
                <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>next_r</span><span style=color:#111>,</span> <span style=color:#111>next_c</span><span style=color:#111>)</span> <span style=color:#f92672>in</span> <span style=color:#111>visited</span><span style=color:#111>:</span> <span style=color:#00a8c8>continue</span>

                <span style=color:#111>next_k</span> <span style=color:#f92672>=</span> <span style=color:#111>k</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span> <span style=color:#00a8c8>if</span> <span style=color:#111>has_obstacle</span><span style=color:#111>(</span><span style=color:#111>next_r</span><span style=color:#111>,</span> <span style=color:#111>next_c</span><span style=color:#111>)</span> <span style=color:#00a8c8>else</span> <span style=color:#111>k</span>
                <span style=color:#00a8c8>if</span> <span style=color:#111>next_k</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span><span style=color:#111>:</span> <span style=color:#00a8c8>continue</span>

                <span style=color:#111>heappush</span><span style=color:#111>(</span><span style=color:#111>cells_to_visit</span><span style=color:#111>,</span> <span style=color:#111>(</span><span style=color:#111>num_steps</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>(</span><span style=color:#111>next_r</span><span style=color:#111>,</span> <span style=color:#111>next_c</span><span style=color:#111>,</span> <span style=color:#111>next_k</span><span style=color:#111>)))</span>

        <span style=color:#00a8c8>return</span> <span style=color:#111>inf</span>

    <span style=color:#111>fewest_steps_to_dest</span> <span style=color:#f92672>=</span> <span style=color:#111>bfs</span><span style=color:#111>()</span>
    <span style=color:#00a8c8>return</span> <span style=color:#111>fewest_steps_to_dest</span> <span style=color:#00a8c8>if</span> <span style=color:#111>fewest_steps_to_dest</span> <span style=color:#f92672>!=</span> <span style=color:#111>inf</span> <span style=color:#00a8c8>else</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</code></pre></div></details><p>The above implementation passes 23 of 55 test cases, and fails for being
too slow.</p><h2 id=learnings-from-others-solutions>Learnings from Others' Solutions</h2><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-py data-lang=py><span style=color:#00a8c8>if</span> <span style=color:#111>has_obstacle</span><span style=color:#111>(</span><span style=color:#111>next_r</span><span style=color:#111>,</span> <span style=color:#111>next_c</span><span style=color:#111>)</span> <span style=color:#f92672>and</span> <span style=color:#111>k</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>and</span> <span style=color:#111>(</span><span style=color:#111>next_r</span><span style=color:#111>,</span> <span style=color:#111>next_c</span><span style=color:#111>,</span> <span style=color:#111>k</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>)</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> <span style=color:#111>visited</span><span style=color:#111>:</span>
    <span style=color:#111>visited</span><span style=color:#f92672>.</span><span style=color:#111>add</span><span style=color:#111>((</span><span style=color:#111>next_r</span><span style=color:#111>,</span> <span style=color:#111>next_c</span><span style=color:#111>,</span> <span style=color:#111>k</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>))</span>
    <span style=color:#111>cells_to_visit</span><span style=color:#f92672>.</span><span style=color:#111>append</span><span style=color:#111>((</span><span style=color:#111>num_steps</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>next_r</span><span style=color:#111>,</span> <span style=color:#111>next_c</span><span style=color:#111>,</span> <span style=color:#111>k</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>))</span>

<span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#f92672>not</span> <span style=color:#111>has_obstacle</span><span style=color:#111>(</span><span style=color:#111>next_r</span><span style=color:#111>,</span> <span style=color:#111>next_c</span><span style=color:#111>))</span> <span style=color:#f92672>and</span> <span style=color:#111>(</span><span style=color:#111>next_r</span><span style=color:#111>,</span> <span style=color:#111>next_c</span><span style=color:#111>,</span> <span style=color:#111>k</span><span style=color:#111>)</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> <span style=color:#111>visited</span><span style=color:#111>:</span>
    <span style=color:#111>visited</span><span style=color:#f92672>.</span><span style=color:#111>add</span><span style=color:#111>((</span><span style=color:#111>next_r</span><span style=color:#111>,</span> <span style=color:#111>next_c</span><span style=color:#111>,</span> <span style=color:#111>k</span><span style=color:#111>))</span>
    <span style=color:#111>cells_to_visit</span><span style=color:#f92672>.</span><span style=color:#111>append</span><span style=color:#111>((</span><span style=color:#111>num_steps</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>next_r</span><span style=color:#111>,</span> <span style=color:#111>next_c</span><span style=color:#111>,</span> <span style=color:#111>k</span><span style=color:#111>))</span>
</code></pre></div><h2 id=references>References</h2><ol><li><div class=citation citation-icon-class="fas fa-fw fa-globe" cited-by-count is-main><cite id=laser2019>Shortest Path in a Grid with Obstacles Elimination - LeetCode<i>.</i></cite>
<a href=https://leetcode.com/problems/shortest-path-in-a-grid-with-obstacles-elimination/solutions/451787/python-o-m-n-k-bfs-solution-with-explanation/ target=_blank rel=noopener><img src="https://www.google.com/s2/favicons?domain=leetcode.com" loading=lazy aria-hidden=true width=16 height=16>
<i>leetcode.com</i> <i class="fas fa-fw fa-external-link-alt" aria-hidden=true></i></a>.
Dec 14, 2019.
<i class="fas fa-fw fa-globe" aria-hidden=true></i>Accessed Jul 22, 2024.</div></li></ol></article><div style=font-size:smaller><aside id=domains-holder style="margin:0 0 2%">Cited Domains:
<a href=/domains/leetcode.com style="margin:0 2px"><img src="https://www.google.com/s2/favicons?domain=leetcode.com" loading=lazy aria-hidden=true width=16 height=16>
leetcode.com</a></aside></div></div><footer><a href=https://www.curiosities.dev/computer-science/programming-challenges/leet-code-and-others/grids/queens_attack_ii/>&#171; Queen's Movements on a Chessboard w/ Obstacles</a></footer></section></div><footer><a href=mailto:d.chege711@gmail.com>Email</a>
<a href=/about>About</a>
<a href=/search>Search</a></footer></body></html>