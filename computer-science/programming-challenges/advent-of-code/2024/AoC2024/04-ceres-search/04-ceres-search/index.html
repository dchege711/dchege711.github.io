<!doctype html><html lang=en><head><title>AoC 2024 Day 04: Ceres Search | curiosities.dev</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo (https://gohugo.io/)"><meta name=description content="Problem This word search allows words to be horizontal, vertical, diagonal, written backwards, or even overlapping other words. Here are a few ways XMAS might appear, where irrelevant characters have been replaced with .:
..X... .SAMX. .A..A. XMAS.S .X.... The actual word search will be full of letters instead. For example:
MMMSXXMASM MSAMXMSMSA AMXSXMAAMM MSAMASMSMX XMASAMXAMM XXAMMXXAMA SMSMSASXSS SAXAMASAAA MAMMMXMMMM MXMXAXMASX Parsing namespace AoC2024; public partial class CeresSearch { private readonly char[,] grid; public CeresSearch(string filePath) { using StreamReader inputReader = new(filePath); List<char[]> rows = []; string?..."><meta property="og:title" content="AoC 2024 Day 04: Ceres Search"><meta property="og:description" content="Problem This word search allows words to be horizontal, vertical, diagonal, written backwards, or even overlapping other words. Here are a few ways XMAS might appear, where irrelevant characters have been replaced with .:
..X... .SAMX. .A..A. XMAS.S .X.... The actual word search will be full of letters instead. For example:
MMMSXXMASM MSAMXMSMSA AMXSXMAAMM MSAMASMSMX XMASAMXAMM XXAMMXXAMA SMSMSASXSS SAXAMASAAA MAMMMXMMMM MXMXAXMASX Parsing namespace AoC2024; public partial class CeresSearch { private readonly char[,] grid; public CeresSearch(string filePath) { using StreamReader inputReader = new(filePath); List<char[]> rows = []; string?..."><meta property="og:type" content="website"><meta property="og:url" content="https://www.curiosities.dev/computer-science/programming-challenges/advent-of-code/2024/AoC2024/04-ceres-search/04-ceres-search/"><meta property="og:site_name" content="curiosities.dev"><link rel=stylesheet type=text/css href=/css/main.min.css><link rel=preload href=/css/all_font_awesome_v5.9.min.min.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=/css/all_font_awesome_v5.9.min.min.css></noscript><link rel="shortcut icon" href=/img/favicon_io/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/img/favicon_io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/img/favicon_io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/img/favicon_io/favicon-16x16.png><script async type=text/javascript src=/js/OrganizeCitations.min.js></script><script async type=text/javascript src=/js/HighlightAnchor.min.js></script><script async type=text/javascript src=/js/SummaryPageUtils.min.js></script><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script><link rel=preload href=/css/vs.min.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=/css/vs.min.css></noscript><script defer type=text/javascript src=/js/highlight.min.min.js onload=addURLHighlighter();></script><script defer>const hjlsURLRegex=/https?:\/\/[^\s<]+/g
const hjlsCitationRegex=/&lt;span class=&quot;citation-ref&quot;&gt;&lt;a href=&quot;(.*)&quot;&gt;&lt;\/a&gt;&lt;\/span&gt;/g
function addURLHighlighter(){hljs.addPlugin({"after:highlight":(result)=>{result.value=result.value.replaceAll(hjlsURLRegex,"<a href='$&' target='_blank'>$&</a>");console.log(result.value);result.value=result.value.replaceAll(hjlsCitationRegex,"<span class='citation-ref'><a href='$1'></a></span>");}});hljs.highlightAll();}</script></head><body><div class=container id=main_div><form action=/search method=get id=globalSearchForm><input type=text id=q name=q title="Search Query">
<input type=submit id=submitButton value=Search></form><nav aria-label=Breadcrumb class=breadcrumb><ul><li><a href=https://www.curiosities.dev/>Home</a></li><li><a href=https://www.curiosities.dev/computer-science/>Computer Science & Software Engineering</a></li><li><a href=https://www.curiosities.dev/computer-science/programming-challenges/>Programming Challenges</a></li><li><a href=https://www.curiosities.dev/computer-science/programming-challenges/advent-of-code/>Advent of Code</a></li><li><a href=https://www.curiosities.dev/computer-science/programming-challenges/advent-of-code/2024/>Advent of Code 2024 - C#</a></li><li class=active><a href=https://www.curiosities.dev/computer-science/programming-challenges/advent-of-code/2024/AoC2024/04-ceres-search/04-ceres-search/>AoC 2024 Day 04: Ceres Search</a></li></ul></nav><section><header><h1>AoC 2024 Day 04: Ceres Search</h1><p class=meta>Dated Aug 23, 2025;
last modified on Sat, 23 Aug 2025</p></header><div id=toc-then-article><aside id=toc><nav id=TableOfContents><ul><li><a href=#problem>Problem</a></li><li><a href=#parsing>Parsing</a></li><li><a href=#part-one>Part One</a></li><li><a href=#part-two>Part Two</a></li><li><a href=#references>References</a></li></ul></nav></aside><article id=main-article><h2 id=problem>Problem</h2><p>This word search allows words to be horizontal, vertical, diagonal, written
backwards, or even overlapping other words. Here are a few ways <code>XMAS</code> might
appear, where irrelevant characters have been replaced with <code>.</code>:</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-txt data-lang=txt>..X...
.SAMX.
.A..A.
XMAS.S
.X....
</code></pre></div><p>The actual word search will be full of letters instead. For example:</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-txt data-lang=txt>MMMSXXMASM
MSAMXMSMSA
AMXSXMAAMM
MSAMASMSMX
XMASAMXAMM
XXAMMXXAMA
SMSMSASXSS
SAXAMASAAA
MAMMMXMMMM
MXMXAXMASX
</code></pre></div><h2 id=parsing>Parsing</h2><div id=CeresSearch.Parse.cs><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cs data-lang=cs><span style=color:#00a8c8>namespace</span> <span style=color:#111>AoC2024</span><span style=color:#111>;</span>

<span style=color:#00a8c8>public</span> <span style=color:#00a8c8>partial</span> <span style=color:#00a8c8>class</span> <span style=color:#75af00>CeresSearch</span>
<span style=color:#111>{</span>
    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>readonly</span> <span style=color:#00a8c8>char</span><span style=color:#111>[,]</span> <span style=color:#111>grid</span><span style=color:#111>;</span>

    <span style=color:#00a8c8>public</span> <span style=color:#111>CeresSearch</span><span style=color:#111>(</span><span style=color:#00a8c8>string</span> <span style=color:#111>filePath</span><span style=color:#111>)</span>
    <span style=color:#111>{</span>
        <span style=color:#00a8c8>using</span> <span style=color:#111>StreamReader</span> <span style=color:#111>inputReader</span> <span style=color:#111>=</span> <span style=color:#00a8c8>new</span><span style=color:#111>(</span><span style=color:#111>filePath</span><span style=color:#111>);</span>
        <span style=color:#111>List</span><span style=color:#111>&lt;</span><span style=color:#00a8c8>char</span><span style=color:#111>[]&gt;</span> <span style=color:#111>rows</span> <span style=color:#111>=</span> <span style=color:#111>[];</span>
        <span style=color:#00a8c8>string?</span> <span style=color:#111>line</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>while</span><span style=color:#111>((</span><span style=color:#111>line</span> <span style=color:#111>=</span> <span style=color:#111>inputReader</span><span style=color:#111>.</span><span style=color:#111>ReadLine</span><span style=color:#111>())</span> <span style=color:#111>!=</span> <span style=color:#00a8c8>null</span><span style=color:#111>)</span>
            <span style=color:#111>rows</span><span style=color:#111>.</span><span style=color:#111>Add</span><span style=color:#111>(</span><span style=color:#111>line</span><span style=color:#111>.</span><span style=color:#111>ToCharArray</span><span style=color:#111>());</span>

        <span style=color:#00a8c8>int</span> <span style=color:#111>rowCount</span> <span style=color:#111>=</span> <span style=color:#111>rows</span><span style=color:#111>.</span><span style=color:#111>Count</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>colCount</span> <span style=color:#111>=</span> <span style=color:#111>rows</span><span style=color:#111>.</span><span style=color:#111>First</span><span style=color:#111>().</span><span style=color:#111>Length</span><span style=color:#111>;</span>

        <span style=color:#111>grid</span> <span style=color:#111>=</span> <span style=color:#00a8c8>new</span> <span style=color:#00a8c8>char</span><span style=color:#111>[</span><span style=color:#111>rowCount</span><span style=color:#111>,</span> <span style=color:#111>colCount</span><span style=color:#111>];</span>
        <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>r</span> <span style=color:#111>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>r</span> <span style=color:#111>&lt;</span> <span style=color:#111>rowCount</span><span style=color:#111>;</span> <span style=color:#111>r</span><span style=color:#111>++)</span>
            <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>c</span> <span style=color:#111>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>c</span> <span style=color:#111>&lt;</span> <span style=color:#111>colCount</span><span style=color:#111>;</span> <span style=color:#111>c</span><span style=color:#111>++)</span>
                <span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>]</span> <span style=color:#111>=</span> <span style=color:#111>rows</span><span style=color:#111>[</span><span style=color:#111>r</span><span style=color:#111>][</span><span style=color:#111>c</span><span style=color:#111>];</span>
    <span style=color:#111>}</span>
<span style=color:#111>}</span>
</code></pre></div></div><p>For \(M \times N\) grids, C# has multi-dimensional arrays. These differ from
jagged arrays, whose elements are arrays with possibly different sizes. <span class=citation-ref><a href=#Array></a></span>In memory, multi-dimensional arrays are laid out as 1D arrays. When
processing array data, cache locality impacts performance. If the computation
needs to access multiple rows (e.g., image convolution, this problem), then
multi-dimensional arrays offer an advantage. If processing row-by-row, then
jagged arrays will also have cache locality. However, if the array is larger
than 85Kb, then it ends in the large object heap, which is slower. <span class=citation-ref><a href=#Mirkovic2024></a></span></p><h2 id=part-one>Part One</h2><p><strong>How many times does XMAS appear</strong>? In this word search, <code>XMAS</code> occurs <code>18</code>
times:</p><table><thead><tr><th></th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th></tr></thead><tbody><tr><td>0</td><td>.</td><td>.</td><td>.</td><td>.</td><td>X</td><td>X</td><td>M</td><td>A</td><td>S</td><td>.</td></tr><tr><td>1</td><td>.</td><td>S</td><td>A</td><td>M</td><td>X</td><td>M</td><td>S</td><td>.</td><td>.</td><td>.</td></tr><tr><td>2</td><td>.</td><td>.</td><td>.</td><td>S</td><td>.</td><td>.</td><td>A</td><td>.</td><td>.</td><td>.</td></tr><tr><td>3</td><td>.</td><td>.</td><td>A</td><td>.</td><td>A</td><td>.</td><td>M</td><td>S</td><td>.</td><td>X</td></tr><tr><td>4</td><td>X</td><td>M</td><td>A</td><td>S</td><td>A</td><td>M</td><td>X</td><td>.</td><td>M</td><td>M</td></tr><tr><td>5</td><td>X</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>X</td><td>A</td><td>.</td><td>A</td></tr><tr><td>6</td><td>S</td><td>.</td><td>S</td><td>.</td><td>S</td><td>.</td><td>S</td><td>.</td><td>S</td><td>S</td></tr><tr><td>7</td><td>.</td><td>A</td><td>.</td><td>A</td><td>.</td><td>A</td><td>.</td><td>A</td><td>.</td><td>A</td></tr><tr><td>8</td><td>.</td><td>.</td><td>M</td><td>.</td><td>M</td><td>.</td><td>M</td><td>.</td><td>M</td><td>M</td></tr><tr><td>9</td><td>.</td><td>X</td><td>.</td><td>X</td><td>.</td><td>X</td><td>M</td><td>A</td><td>S</td><td>X</td></tr></tbody></table><div id=CeresSearch.PartOne.cs><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cs data-lang=cs><span style=color:#00a8c8>namespace</span> <span style=color:#111>AoC2024</span><span style=color:#111>;</span>

<span style=color:#00a8c8>public</span> <span style=color:#00a8c8>partial</span> <span style=color:#00a8c8>class</span> <span style=color:#75af00>CeresSearch</span>
<span style=color:#111>{</span>
    <span style=color:#00a8c8>static</span> <span style=color:#00a8c8>readonly</span> <span style=color:#00a8c8>private</span> <span style=color:#111>List</span><span style=color:#111>&lt;(</span><span style=color:#00a8c8>int</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span><span style=color:#111>)&gt;</span> <span style=color:#111>possibleMoves</span> <span style=color:#111>=</span> <span style=color:#111>[</span>
        <span style=color:#111>(-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>),</span> <span style=color:#111>(-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>1</span><span style=color:#111>),</span> <span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>1</span><span style=color:#111>),</span> <span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>1</span><span style=color:#111>),</span> <span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>),</span> <span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>-</span><span style=color:#ae81ff>1</span><span style=color:#111>),</span> <span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#111>-</span><span style=color:#ae81ff>1</span><span style=color:#111>),</span> <span style=color:#111>(-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>-</span><span style=color:#ae81ff>1</span><span style=color:#111>)];</span>

    <span style=color:#00a8c8>static</span> <span style=color:#00a8c8>readonly</span> <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>char</span><span style=color:#111>[]</span> <span style=color:#111>targetString</span> <span style=color:#111>=</span> <span style=color:#111>[</span><span style=color:#d88200>&#39;X&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;M&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;A&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;S&#39;</span><span style=color:#111>];</span>

    <span style=color:#00a8c8>public</span> <span style=color:#00a8c8>int</span> <span style=color:#111>PartOne</span><span style=color:#111>()</span> <span style=color:#111>=&gt;</span> 
        <span style=color:#111>Enumerable</span><span style=color:#111>.</span><span style=color:#111>Range</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#111>grid</span><span style=color:#111>.</span><span style=color:#111>GetLength</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>))</span>
            <span style=color:#111>.</span><span style=color:#111>SelectMany</span><span style=color:#111>(</span><span style=color:#111>r</span> <span style=color:#111>=&gt;</span> <span style=color:#111>Enumerable</span><span style=color:#111>.</span><span style=color:#111>Range</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#111>grid</span><span style=color:#111>.</span><span style=color:#111>GetLength</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>))</span>
                <span style=color:#111>.</span><span style=color:#111>Select</span><span style=color:#111>(</span><span style=color:#111>c</span> <span style=color:#111>=&gt;</span> <span style=color:#111>NumOccurrences</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>)))</span>
            <span style=color:#111>.</span><span style=color:#111>Sum</span><span style=color:#111>();</span>

    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>int</span> <span style=color:#111>NumOccurrences</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>c</span><span style=color:#111>)</span>
    <span style=color:#111>{</span>
        <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>]</span> <span style=color:#111>!=</span> <span style=color:#111>targetString</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>])</span>
            <span style=color:#00a8c8>return</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
        
        <span style=color:#00a8c8>return</span> <span style=color:#111>possibleMoves</span>
            <span style=color:#111>.</span><span style=color:#111>Select</span><span style=color:#111>(</span><span style=color:#111>move</span> <span style=color:#111>=&gt;</span> <span style=color:#111>HasPatternStartingFromPosition</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>,</span> <span style=color:#111>move</span><span style=color:#111>.</span><span style=color:#111>Item1</span><span style=color:#111>,</span> <span style=color:#111>move</span><span style=color:#111>.</span><span style=color:#111>Item2</span><span style=color:#111>))</span>
            <span style=color:#111>.</span><span style=color:#111>Count</span><span style=color:#111>(</span><span style=color:#111>hasPattern</span> <span style=color:#111>=&gt;</span> <span style=color:#111>hasPattern</span><span style=color:#111>);</span>
    <span style=color:#111>}</span>

    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>bool</span> <span style=color:#111>HasPatternStartingFromPosition</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>c</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>dr</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>dc</span><span style=color:#111>)</span>
    <span style=color:#111>{</span>
        <span style=color:#00a8c8>return</span> <span style=color:#111>targetString</span><span style=color:#111>.</span><span style=color:#111>Index</span><span style=color:#111>()</span>
            <span style=color:#111>.</span><span style=color:#111>All</span><span style=color:#111>(</span><span style=color:#111>indexAndChar</span> <span style=color:#111>=&gt;</span> <span style=color:#111>{</span>
                <span style=color:#00a8c8>int</span> <span style=color:#111>nr</span> <span style=color:#111>=</span> <span style=color:#111>r</span> <span style=color:#111>+</span> <span style=color:#111>indexAndChar</span><span style=color:#111>.</span><span style=color:#111>Index</span> <span style=color:#111>*</span> <span style=color:#111>dr</span><span style=color:#111>;</span>
                <span style=color:#00a8c8>int</span> <span style=color:#111>nc</span> <span style=color:#111>=</span> <span style=color:#111>c</span> <span style=color:#111>+</span> <span style=color:#111>indexAndChar</span><span style=color:#111>.</span><span style=color:#111>Index</span> <span style=color:#111>*</span> <span style=color:#111>dc</span><span style=color:#111>;</span>
                <span style=color:#00a8c8>return</span> <span style=color:#111>nr</span> <span style=color:#111>&gt;=</span> <span style=color:#ae81ff>0</span>
                    <span style=color:#111>&amp;&amp;</span> <span style=color:#111>nr</span> <span style=color:#111>&lt;</span> <span style=color:#111>grid</span><span style=color:#111>.</span><span style=color:#111>GetLength</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>)</span>
                    <span style=color:#111>&amp;&amp;</span> <span style=color:#111>nc</span> <span style=color:#111>&gt;=</span> <span style=color:#ae81ff>0</span>
                    <span style=color:#111>&amp;&amp;</span> <span style=color:#111>nc</span> <span style=color:#111>&lt;</span> <span style=color:#111>grid</span><span style=color:#111>.</span><span style=color:#111>GetLength</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span>
                    <span style=color:#111>&amp;&amp;</span> <span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#111>nr</span><span style=color:#111>,</span> <span style=color:#111>nc</span><span style=color:#111>]</span> <span style=color:#111>==</span> <span style=color:#111>indexAndChar</span><span style=color:#111>.</span><span style=color:#111>Item</span><span style=color:#111>;</span>
            <span style=color:#111>});</span>
    <span style=color:#111>}</span>
<span style=color:#111>}</span>
</code></pre></div></div><p>The declarative form packs quite the punch:</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cs data-lang=cs><span style=color:#00a8c8>return</span> <span style=color:#111>Enumerable</span><span style=color:#111>.</span><span style=color:#111>Range</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#111>grid</span><span style=color:#111>.</span><span style=color:#111>GetLength</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>))</span>
  <span style=color:#111>.</span><span style=color:#111>SelectMany</span><span style=color:#111>(</span><span style=color:#111>r</span> <span style=color:#111>=&gt;</span> <span style=color:#111>Enumerable</span><span style=color:#111>.</span><span style=color:#111>Range</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#111>grid</span><span style=color:#111>.</span><span style=color:#111>GetLength</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>))</span>
    <span style=color:#111>.</span><span style=color:#111>Select</span><span style=color:#111>(</span><span style=color:#111>c</span> <span style=color:#111>=&gt;</span> <span style=color:#111>NumOccurrences</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>)))</span>
  <span style=color:#111>.</span><span style=color:#111>Sum</span><span style=color:#111>()</span>
</code></pre></div><p><code>r</code> is a variable that is in scope when <code>c => ...</code> is defined. When <code>c => ...</code>
uses <code>r</code>, it captures it. <code>r</code> is stored for use in <code>c => ...</code> even if <code>r</code> would
have otherwise gone out of scope. <span class=citation-ref><a href=#LambdaExpressions></a></span></p><h2 id=part-two>Part Two</h2><p>Find two <code>MAS</code> in the shape of an <code>X</code>, e.g.,</p><table><tr><td>M</td><td>.</td><td>S</td></tr><tr><td>.</td><td>A</td><td>.</td></tr><tr><td>M</td><td>.</td><td>S</td></tr></table><p>Within the <code>X</code>, each <code>MAS</code> can be written forwards or backwards.</p><p><strong>How many times does an <code>X-MAS</code> appear</strong>? In this example, an <code>X-MAS</code> appears
<code>9</code> times:</p><table><thead><tr><th></th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th></tr></thead><tbody><tr><td>0</td><td>.</td><td>M</td><td>.</td><td>S</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td></tr><tr><td>1</td><td>.</td><td>.</td><td>A</td><td>.</td><td>.</td><td>M</td><td>S</td><td>M</td><td>S</td><td>.</td></tr><tr><td>2</td><td>.</td><td>M</td><td>.</td><td>S</td><td>.</td><td>M</td><td>A</td><td>A</td><td>.</td><td>.</td></tr><tr><td>3</td><td>.</td><td>.</td><td>A</td><td>.</td><td>A</td><td>S</td><td>M</td><td>S</td><td>M</td><td>.</td></tr><tr><td>4</td><td>.</td><td>M</td><td>.</td><td>S</td><td>.</td><td>M</td><td>.</td><td>.</td><td>.</td><td>.</td></tr><tr><td>5</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td></tr><tr><td>6</td><td>S</td><td>.</td><td>S</td><td>.</td><td>S</td><td>.</td><td>S</td><td>.</td><td>S</td><td>.</td></tr><tr><td>7</td><td>.</td><td>A</td><td>.</td><td>A</td><td>.</td><td>A</td><td>.</td><td>A</td><td>.</td><td>.</td></tr><tr><td>8</td><td>M</td><td>.</td><td>M</td><td>.</td><td>M</td><td>.</td><td>M</td><td>.</td><td>M</td><td>.</td></tr><tr><td>9</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td></tr></tbody></table><div id=CeresSearch.PartTwo.cs><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cs data-lang=cs><span style=color:#00a8c8>using</span> <span style=color:#111>System.Collections.Immutable</span><span style=color:#111>;</span>
<span style=color:#00a8c8>using</span> <span style=color:#111>System.Diagnostics</span><span style=color:#111>;</span>

<span style=color:#00a8c8>namespace</span> <span style=color:#111>AoC2024</span><span style=color:#111>;</span>

<span style=color:#00a8c8>public</span> <span style=color:#00a8c8>partial</span> <span style=color:#00a8c8>class</span> <span style=color:#75af00>CeresSearch</span>
<span style=color:#111>{</span>
    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>readonly</span> <span style=color:#00a8c8>static</span> <span style=color:#00a8c8>string</span> <span style=color:#111>crossTargetString</span> <span style=color:#111>=</span> <span style=color:#d88200>&#34;MAS&#34;</span><span style=color:#111>;</span>
    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>readonly</span> <span style=color:#00a8c8>static</span> <span style=color:#111>ImmutableHashSet</span><span style=color:#111>&lt;</span><span style=color:#00a8c8>string</span><span style=color:#111>&gt;</span> <span style=color:#111>crossTargetStringVariations</span> <span style=color:#111>=</span> <span style=color:#111>[</span>
        <span style=color:#111>crossTargetString</span><span style=color:#111>,</span> <span style=color:#00a8c8>string</span><span style=color:#111>.</span><span style=color:#111>Concat</span><span style=color:#111>(</span><span style=color:#111>crossTargetString</span><span style=color:#111>.</span><span style=color:#111>Reverse</span><span style=color:#111>())];</span>
    
    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>readonly</span> <span style=color:#00a8c8>static</span> <span style=color:#00a8c8>int</span> <span style=color:#111>crossTargetStringRadius</span> <span style=color:#111>=</span> <span style=color:#111>crossTargetString</span><span style=color:#111>.</span><span style=color:#111>Length</span> <span style=color:#111>/</span> <span style=color:#ae81ff>2</span><span style=color:#111>;</span>

    <span style=color:#00a8c8>static</span> <span style=color:#111>CeresSearch</span><span style=color:#111>()</span>
    <span style=color:#111>{</span>
        <span style=color:#111>Debug</span><span style=color:#111>.</span><span style=color:#111>Assert</span><span style=color:#111>(</span><span style=color:#111>crossTargetString</span><span style=color:#111>.</span><span style=color:#111>Length</span> <span style=color:#111>%</span> <span style=color:#ae81ff>2</span> <span style=color:#111>==</span> <span style=color:#ae81ff>1</span><span style=color:#111>,</span> 
            <span style=color:#d88200>$&#34;{nameof(crossTargetString)} must be an odd-length string&#34;</span><span style=color:#111>);</span>
    <span style=color:#111>}</span>

    <span style=color:#00a8c8>public</span> <span style=color:#00a8c8>int</span> <span style=color:#111>PartTwo</span><span style=color:#111>()</span> <span style=color:#111>=&gt;</span>
        <span style=color:#111>Enumerable</span><span style=color:#111>.</span><span style=color:#111>Range</span><span style=color:#111>(</span><span style=color:#111>crossTargetStringRadius</span><span style=color:#111>,</span> <span style=color:#111>grid</span><span style=color:#111>.</span><span style=color:#111>GetLength</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>)</span> <span style=color:#111>-</span> <span style=color:#111>crossTargetStringRadius</span><span style=color:#111>)</span>
            <span style=color:#111>.</span><span style=color:#111>SelectMany</span><span style=color:#111>(</span><span style=color:#111>r</span> <span style=color:#111>=&gt;</span> <span style=color:#111>Enumerable</span><span style=color:#111>.</span><span style=color:#111>Range</span><span style=color:#111>(</span><span style=color:#111>crossTargetStringRadius</span><span style=color:#111>,</span> <span style=color:#111>grid</span><span style=color:#111>.</span><span style=color:#111>GetLength</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span> <span style=color:#111>-</span> <span style=color:#111>crossTargetStringRadius</span><span style=color:#111>)</span>
                <span style=color:#111>.</span><span style=color:#111>Select</span><span style=color:#111>(</span><span style=color:#111>c</span> <span style=color:#111>=&gt;</span> <span style=color:#111>HasCrossOccurence</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>)))</span>
            <span style=color:#111>.</span><span style=color:#111>Count</span><span style=color:#111>(</span><span style=color:#111>found</span> <span style=color:#111>=&gt;</span> <span style=color:#111>found</span><span style=color:#111>);</span>

    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>bool</span> <span style=color:#111>HasCrossOccurence</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>c</span><span style=color:#111>)</span>
    <span style=color:#111>{</span>        
        <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>]</span> <span style=color:#111>!=</span> <span style=color:#111>crossTargetString</span><span style=color:#111>[</span><span style=color:#111>crossTargetStringRadius</span><span style=color:#111>])</span>
            <span style=color:#00a8c8>return</span> <span style=color:#00a8c8>false</span><span style=color:#111>;</span>

        <span style=color:#00a8c8>var</span> <span style=color:#111>crossPaths</span> <span style=color:#111>=</span> <span style=color:#111>GetCrossPaths</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>);</span>
        <span style=color:#00a8c8>if</span> <span style=color:#111>(!</span><span style=color:#111>crossPaths</span><span style=color:#111>.</span><span style=color:#111>Any</span><span style=color:#111>())</span>
            <span style=color:#00a8c8>return</span> <span style=color:#00a8c8>false</span><span style=color:#111>;</span>
        
        <span style=color:#00a8c8>return</span> <span style=color:#111>crossPaths</span><span style=color:#111>.</span><span style=color:#111>All</span><span style=color:#111>(</span><span style=color:#111>coordinates</span> <span style=color:#111>=&gt;</span> <span style=color:#111>{</span>
            <span style=color:#00a8c8>var</span> <span style=color:#111>chars</span> <span style=color:#111>=</span> <span style=color:#111>coordinates</span><span style=color:#111>.</span><span style=color:#111>Select</span><span style=color:#111>(</span><span style=color:#111>coordinate</span> <span style=color:#111>=&gt;</span> <span style=color:#111>grid</span><span style=color:#111>[</span><span style=color:#111>coordinate</span><span style=color:#111>.</span><span style=color:#111>R</span><span style=color:#111>,</span> <span style=color:#111>coordinate</span><span style=color:#111>.</span><span style=color:#111>C</span><span style=color:#111>]);</span>            
            <span style=color:#00a8c8>return</span> <span style=color:#111>crossTargetStringVariations</span><span style=color:#111>.</span><span style=color:#111>Contains</span><span style=color:#111>(</span><span style=color:#00a8c8>string</span><span style=color:#111>.</span><span style=color:#111>Concat</span><span style=color:#111>(</span><span style=color:#111>chars</span><span style=color:#111>));</span>
        <span style=color:#111>});</span>
    <span style=color:#111>}</span>

    <span style=color:#00a8c8>private</span> <span style=color:#111>IEnumerable</span><span style=color:#111>&lt;</span><span style=color:#111>IEnumerable</span><span style=color:#111>&lt;</span><span style=color:#111>Coordinates</span><span style=color:#111>&gt;&gt;</span> <span style=color:#111>GetCrossPaths</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>c</span><span style=color:#111>)</span>
    <span style=color:#111>{</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>topR</span> <span style=color:#111>=</span> <span style=color:#111>r</span> <span style=color:#111>-</span> <span style=color:#111>crossTargetStringRadius</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>bottomR</span> <span style=color:#111>=</span> <span style=color:#111>r</span> <span style=color:#111>+</span> <span style=color:#111>crossTargetStringRadius</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>leftC</span> <span style=color:#111>=</span> <span style=color:#111>c</span> <span style=color:#111>-</span> <span style=color:#111>crossTargetStringRadius</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>rightC</span> <span style=color:#111>=</span> <span style=color:#111>c</span> <span style=color:#111>+</span> <span style=color:#111>crossTargetStringRadius</span><span style=color:#111>;</span>

        <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>topR</span> <span style=color:#111>&lt;</span> <span style=color:#ae81ff>0</span> <span style=color:#111>||</span> <span style=color:#111>bottomR</span> <span style=color:#111>&gt;=</span> <span style=color:#111>grid</span><span style=color:#111>.</span><span style=color:#111>GetLength</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>)</span> <span style=color:#111>||</span> <span style=color:#111>leftC</span> <span style=color:#111>&lt;</span> <span style=color:#ae81ff>0</span> <span style=color:#111>||</span> <span style=color:#111>rightC</span> <span style=color:#111>&gt;=</span> <span style=color:#111>grid</span><span style=color:#111>.</span><span style=color:#111>GetLength</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>))</span>
            <span style=color:#00a8c8>yield</span> <span style=color:#00a8c8>break</span><span style=color:#111>;</span>

        <span style=color:#00a8c8>yield</span> <span style=color:#00a8c8>return</span> <span style=color:#111>GetRange</span><span style=color:#111>(</span><span style=color:#00a8c8>new</span><span style=color:#111>(</span><span style=color:#111>topR</span><span style=color:#111>,</span> <span style=color:#111>leftC</span><span style=color:#111>),</span> <span style=color:#00a8c8>new</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>1</span><span style=color:#111>),</span> <span style=color:#111>crossTargetString</span><span style=color:#111>.</span><span style=color:#111>Length</span><span style=color:#111>);</span>
        <span style=color:#00a8c8>yield</span> <span style=color:#00a8c8>return</span> <span style=color:#111>GetRange</span><span style=color:#111>(</span><span style=color:#00a8c8>new</span><span style=color:#111>(</span><span style=color:#111>topR</span><span style=color:#111>,</span> <span style=color:#111>rightC</span><span style=color:#111>),</span> <span style=color:#00a8c8>new</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>-</span><span style=color:#ae81ff>1</span><span style=color:#111>),</span> <span style=color:#111>crossTargetString</span><span style=color:#111>.</span><span style=color:#111>Length</span><span style=color:#111>);</span>
    <span style=color:#111>}</span>

    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>static</span> <span style=color:#111>IEnumerable</span><span style=color:#111>&lt;</span><span style=color:#111>Coordinates</span><span style=color:#111>&gt;</span> <span style=color:#111>GetRange</span><span style=color:#111>(</span>
        <span style=color:#111>Coordinates</span> <span style=color:#111>start</span><span style=color:#111>,</span>
        <span style=color:#111>Coordinates</span> <span style=color:#111>delta</span><span style=color:#111>,</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>count</span><span style=color:#111>)</span>
    <span style=color:#111>{</span>
        <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>var</span> <span style=color:#111>i</span> <span style=color:#111>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>i</span> <span style=color:#111>&lt;</span> <span style=color:#111>count</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#111>++)</span>
            <span style=color:#00a8c8>yield</span> <span style=color:#00a8c8>return</span> <span style=color:#00a8c8>new</span><span style=color:#111>(</span><span style=color:#111>start</span><span style=color:#111>.</span><span style=color:#111>R</span> <span style=color:#111>+</span> <span style=color:#111>i</span> <span style=color:#111>*</span> <span style=color:#111>delta</span><span style=color:#111>.</span><span style=color:#111>R</span><span style=color:#111>,</span> <span style=color:#111>start</span><span style=color:#111>.</span><span style=color:#111>C</span> <span style=color:#111>+</span> <span style=color:#111>i</span> <span style=color:#111>*</span> <span style=color:#111>delta</span><span style=color:#111>.</span><span style=color:#111>C</span><span style=color:#111>);</span>
    <span style=color:#111>}</span>

    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>readonly</span> <span style=color:#111>record</span> <span style=color:#00a8c8>struct</span> <span style=color:#75af00>Coordinates</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>R</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>C</span><span style=color:#111>);</span>
<span style=color:#111>}</span>
</code></pre></div></div><h2 id=references>References</h2><ol><li><div class=citation citation-icon-class="fas fa-fw fa-globe" cited-by-count is-main><cite id=AoC2024Day04>Day 4 - Advent of Code 2024: Ceres Search<i>.</i></cite>
Eric Wastl.
<a href=https://adventofcode.com/2024/day/4 target=_blank rel=noopener><img src="https://www.google.com/s2/favicons?domain=adventofcode.com" loading=lazy aria-hidden=true width=16 height=16>
<i>adventofcode.com</i> <i class="fas fa-fw fa-external-link-alt" aria-hidden=true></i></a>.
<i class="fas fa-fw fa-globe" aria-hidden=true></i>Accessed Aug 23, 2025.</div></li><li><div class=citation citation-icon-class="fas fa-fw fa-globe" cited-by-count is-main><cite id=Array>The array reference type - C# reference | Microsoft Learn<i>.</i></cite>
<a href=https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/arrays target=_blank rel=noopener><img src="https://www.google.com/s2/favicons?domain=learn.microsoft.com" loading=lazy aria-hidden=true width=16 height=16>
<i>learn.microsoft.com</i> <i class="fas fa-fw fa-external-link-alt" aria-hidden=true></i></a>.
<i class="fas fa-fw fa-globe" aria-hidden=true></i>Accessed Sep 7, 2025.</div></li><li><div class=citation citation-icon-class="fas fa-fw fa-globe" cited-by-count is-main><cite id=Mirkovic2024>Multidimensional Array vs Jagged Array in C#<i>.</i></cite>
Dusko Mirkovic.
<a href=https://code-maze.com/charp-multidimensional-jagged-array/ target=_blank rel=noopener><img src="https://www.google.com/s2/favicons?domain=code-maze.com" loading=lazy aria-hidden=true width=16 height=16>
<i>code-maze.com</i> <i class="fas fa-fw fa-external-link-alt" aria-hidden=true></i></a>.
Mar 22, 2024.
<i class="fas fa-fw fa-globe" aria-hidden=true></i>Accessed Sep 7, 2025.</div></li><li><div class=citation citation-icon-class="fas fa-fw fa-globe" cited-by-count is-main><cite id=LambdaExpressions>Lambda expressions - Lambda expressions and anonymous functions - C# reference | Microsoft Learn<i>.</i></cite>
<a href=https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/operators/lambda-expressions target=_blank rel=noopener><img src="https://www.google.com/s2/favicons?domain=learn.microsoft.com" loading=lazy aria-hidden=true width=16 height=16>
<i>learn.microsoft.com</i> <i class="fas fa-fw fa-external-link-alt" aria-hidden=true></i></a>.
<i class="fas fa-fw fa-globe" aria-hidden=true></i>Accessed Sep 7, 2025.</div></li></ol></article><div style=font-size:smaller><aside id=authors-holder style="margin:0 0 2%">Cited Authors:
<a href=/cited-authors/Mirkovic-Dusko>Mirkovic, Dusko</a>
<a href=/cited-authors/Wastl-Eric>Wastl, Eric</a></aside><aside id=domains-holder style="margin:0 0 2%">Cited Domains:
<a href=/domains/adventofcode.com style="margin:0 2px"><img src="https://www.google.com/s2/favicons?domain=adventofcode.com" loading=lazy aria-hidden=true width=16 height=16>
adventofcode.com</a>
<a href=/domains/code-maze.com style="margin:0 2px"><img src="https://www.google.com/s2/favicons?domain=code-maze.com" loading=lazy aria-hidden=true width=16 height=16>
code-maze.com</a>
<a href=/domains/learn.microsoft.com style="margin:0 2px"><img src="https://www.google.com/s2/favicons?domain=learn.microsoft.com" loading=lazy aria-hidden=true width=16 height=16>
learn.microsoft.com</a></aside></div></div><footer><a href=https://www.curiosities.dev/computer-science/programming-challenges/advent-of-code/2024/AoC2024/03-null-it-over/03-mull-it-over/>&#171; AoC 2024 Day 03: Mull It Over</a>
<a href=https://www.curiosities.dev/computer-science/programming-challenges/advent-of-code/2024/AoC2024/05-print-queue/05-print-queue/>AoC 2024 Day 05: Print Queue &#187;</a></footer></section></div><footer><a href=/about>About</a>
<a href=/search>Search</a></footer></body></html>