<!doctype html><html lang=en><head><title>AoC 2024 Day 06: Guard Gallivant | curiosities.dev</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo (https://gohugo.io/)"><meta name=description content="Parsing The map shows the current position of the guard with ^ (to indicate the guard is facing up from the perspective of the map). Any obstructions - crates, desks, alchemical reactors, etc., are shown as #.
 ....#..... .........# .......... ..#....... .......#.. .......... .#..^..... ........#. #......... ......#...  using System.Collections.Immutable; namespace AoC2024; public partial class GuardGallivant { public enum Orientation { Up, Right, Down, Left } public readonly record struct Coordinate(int R, int C); public readonly record struct Visit(Coordinate Coordinate, Orientation Orientation); public readonly (int RowCount, int ColCount, HashSet<Coordinate> Obstacles) AreaMap; public readonly Visit StartingPosition; public GuardGallivant(string filePath) { using StreamReader inputReader = new(filePath); HashSet<Coordinate> obstacles = []; Visit?..."><meta property="og:title" content="AoC 2024 Day 06: Guard Gallivant"><meta property="og:description" content="Parsing The map shows the current position of the guard with ^ (to indicate the guard is facing up from the perspective of the map). Any obstructions - crates, desks, alchemical reactors, etc., are shown as #.
 ....#..... .........# .......... ..#....... .......#.. .......... .#..^..... ........#. #......... ......#...  using System.Collections.Immutable; namespace AoC2024; public partial class GuardGallivant { public enum Orientation { Up, Right, Down, Left } public readonly record struct Coordinate(int R, int C); public readonly record struct Visit(Coordinate Coordinate, Orientation Orientation); public readonly (int RowCount, int ColCount, HashSet<Coordinate> Obstacles) AreaMap; public readonly Visit StartingPosition; public GuardGallivant(string filePath) { using StreamReader inputReader = new(filePath); HashSet<Coordinate> obstacles = []; Visit?..."><meta property="og:type" content="website"><meta property="og:url" content="https://www.curiosities.dev/computer-science/programming-challenges/advent-of-code/2024/AoC2024/06-guard-gallivant/06-guard-gallivant/"><meta property="og:site_name" content="curiosities.dev"><link rel=stylesheet type=text/css href=/css/main.min.css><link rel=preload href=/css/all_font_awesome_v5.9.min.min.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=/css/all_font_awesome_v5.9.min.min.css></noscript><link rel="shortcut icon" href=/img/favicon_io/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/img/favicon_io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/img/favicon_io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/img/favicon_io/favicon-16x16.png><script async type=text/javascript src=/js/OrganizeCitations.min.js></script><script async type=text/javascript src=/js/HighlightAnchor.min.js></script><script async type=text/javascript src=/js/SummaryPageUtils.min.js></script><link rel=preload href=/css/vs.min.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=/css/vs.min.css></noscript><script defer type=text/javascript src=/js/highlight.min.min.js onload=addURLHighlighter();></script><script defer>const hjlsURLRegex=/https?:\/\/[^\s<]+/g
const hjlsCitationRegex=/&lt;span class=&quot;citation-ref&quot;&gt;&lt;a href=&quot;(.*)&quot;&gt;&lt;\/a&gt;&lt;\/span&gt;/g
function addURLHighlighter(){hljs.addPlugin({"after:highlight":(result)=>{result.value=result.value.replaceAll(hjlsURLRegex,"<a href='$&' target='_blank'>$&</a>");console.log(result.value);result.value=result.value.replaceAll(hjlsCitationRegex,"<span class='citation-ref'><a href='$1'></a></span>");}});hljs.highlightAll();}</script><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script></head><body><div class=container id=main_div><form action=/search method=get id=globalSearchForm><input type=text id=q name=q title="Search Query">
<input type=submit id=submitButton value=Search></form><nav aria-label=Breadcrumb class=breadcrumb><ul><li><a href=https://www.curiosities.dev/>Home</a></li><li><a href=https://www.curiosities.dev/computer-science/>Computer Science & Software Engineering</a></li><li><a href=https://www.curiosities.dev/computer-science/programming-challenges/>Programming Challenges</a></li><li><a href=https://www.curiosities.dev/computer-science/programming-challenges/advent-of-code/>Advent of Code</a></li><li><a href=https://www.curiosities.dev/computer-science/programming-challenges/advent-of-code/2024/>Advent of Code 2024 - C#</a></li><li class=active><a href=https://www.curiosities.dev/computer-science/programming-challenges/advent-of-code/2024/AoC2024/06-guard-gallivant/06-guard-gallivant/>AoC 2024 Day 06: Guard Gallivant</a></li></ul></nav><section><header><h1>AoC 2024 Day 06: Guard Gallivant</h1><p class=meta>Dated Aug 23, 2025;
last modified on Sat, 23 Aug 2025</p></header><div id=toc-then-article><aside id=toc><nav id=TableOfContents><ul><li><a href=#parsing>Parsing</a></li><li><a href=#part-one>Part One</a></li><li><a href=#part-two>Part Two</a></li><li><a href=#reference>Reference</a></li></ul></nav></aside><article id=main-article><h2 id=parsing>Parsing</h2><p>The map shows the current position of the guard with <code>^</code> (to indicate the guard
is facing <strong>up</strong> from the perspective of the map). Any <strong>obstructions</strong> -
crates, desks, alchemical reactors, etc., are shown as <code>#</code>.</p><table><tr><td>.</td><td>.</td><td>.</td><td>.</td><td>#</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td></tr><tr><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>#</td></tr><tr><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td></tr><tr><td>.</td><td>.</td><td>#</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td></tr><tr><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>#</td><td>.</td><td>.</td></tr><tr><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td></tr><tr><td>.</td><td>#</td><td>.</td><td>.</td><td>^</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td></tr><tr><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>#</td><td>.</td></tr><tr><td>#</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td></tr><tr><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>.</td><td>#</td><td>.</td><td>.</td><td>.</td></tr></table><div id=GuardGallivant.Parse.cs><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cs data-lang=cs><span style=color:#00a8c8>using</span> <span style=color:#111>System.Collections.Immutable</span><span style=color:#111>;</span>

<span style=color:#00a8c8>namespace</span> <span style=color:#111>AoC2024</span><span style=color:#111>;</span>

<span style=color:#00a8c8>public</span> <span style=color:#00a8c8>partial</span> <span style=color:#00a8c8>class</span> <span style=color:#75af00>GuardGallivant</span>
<span style=color:#111>{</span>
    <span style=color:#00a8c8>public</span> <span style=color:#00a8c8>enum</span> <span style=color:#111>Orientation</span> <span style=color:#111>{</span> <span style=color:#111>Up</span><span style=color:#111>,</span> <span style=color:#111>Right</span><span style=color:#111>,</span> <span style=color:#111>Down</span><span style=color:#111>,</span> <span style=color:#111>Left</span> <span style=color:#111>}</span>
    <span style=color:#00a8c8>public</span> <span style=color:#00a8c8>readonly</span> <span style=color:#111>record</span> <span style=color:#00a8c8>struct</span> <span style=color:#75af00>Coordinate</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>R</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>C</span><span style=color:#111>);</span>
    <span style=color:#00a8c8>public</span> <span style=color:#00a8c8>readonly</span> <span style=color:#111>record</span> <span style=color:#00a8c8>struct</span> <span style=color:#75af00>Visit</span><span style=color:#111>(</span><span style=color:#111>Coordinate</span> <span style=color:#111>Coordinate</span><span style=color:#111>,</span> <span style=color:#111>Orientation</span> <span style=color:#111>Orientation</span><span style=color:#111>);</span>
    
    <span style=color:#00a8c8>public</span> <span style=color:#00a8c8>readonly</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>RowCount</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>ColCount</span><span style=color:#111>,</span> <span style=color:#111>HashSet</span><span style=color:#111>&lt;</span><span style=color:#111>Coordinate</span><span style=color:#111>&gt;</span> <span style=color:#111>Obstacles</span><span style=color:#111>)</span> <span style=color:#111>AreaMap</span><span style=color:#111>;</span>
    <span style=color:#00a8c8>public</span> <span style=color:#00a8c8>readonly</span> <span style=color:#111>Visit</span> <span style=color:#111>StartingPosition</span><span style=color:#111>;</span>

    <span style=color:#00a8c8>public</span> <span style=color:#111>GuardGallivant</span><span style=color:#111>(</span><span style=color:#00a8c8>string</span> <span style=color:#111>filePath</span><span style=color:#111>)</span>
    <span style=color:#111>{</span>
        <span style=color:#00a8c8>using</span> <span style=color:#111>StreamReader</span> <span style=color:#111>inputReader</span> <span style=color:#111>=</span> <span style=color:#00a8c8>new</span><span style=color:#111>(</span><span style=color:#111>filePath</span><span style=color:#111>);</span>
    
        <span style=color:#111>HashSet</span><span style=color:#111>&lt;</span><span style=color:#111>Coordinate</span><span style=color:#111>&gt;</span> <span style=color:#111>obstacles</span> <span style=color:#111>=</span> <span style=color:#111>[];</span>
        <span style=color:#111>Visit</span><span style=color:#111>?</span> <span style=color:#111>maybeStartingPosition</span> <span style=color:#111>=</span> <span style=color:#00a8c8>null</span><span style=color:#111>;</span>

        <span style=color:#00a8c8>string?</span> <span style=color:#111>line</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>r</span> <span style=color:#111>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>colsCount</span> <span style=color:#111>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>while</span><span style=color:#111>((</span><span style=color:#111>line</span> <span style=color:#111>=</span> <span style=color:#111>inputReader</span><span style=color:#111>.</span><span style=color:#111>ReadLine</span><span style=color:#111>())</span> <span style=color:#00a8c8>is</span> <span style=color:#111>not</span> <span style=color:#00a8c8>null</span><span style=color:#111>)</span>
        <span style=color:#111>{</span>
            <span style=color:#00a8c8>var</span> <span style=color:#111>cols</span> <span style=color:#111>=</span> <span style=color:#111>line</span><span style=color:#111>.</span><span style=color:#111>ToCharArray</span><span style=color:#111>().</span><span style=color:#111>Index</span><span style=color:#111>().</span><span style=color:#111>ToList</span><span style=color:#111>();</span>
            <span style=color:#111>cols</span>
                <span style=color:#111>.</span><span style=color:#111>ForEach</span><span style=color:#111>(</span><span style=color:#111>pair</span> <span style=color:#111>=&gt;</span> <span style=color:#111>{</span>
                    <span style=color:#111>Coordinate</span> <span style=color:#111>coordinate</span> <span style=color:#111>=</span> <span style=color:#00a8c8>new</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>pair</span><span style=color:#111>.</span><span style=color:#111>Index</span><span style=color:#111>);</span>
                    <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>IsObstacle</span><span style=color:#111>(</span><span style=color:#111>pair</span><span style=color:#111>.</span><span style=color:#111>Item</span><span style=color:#111>))</span>
                    <span style=color:#111>{</span>
                        <span style=color:#111>obstacles</span><span style=color:#111>.</span><span style=color:#111>Add</span><span style=color:#111>(</span><span style=color:#111>coordinate</span><span style=color:#111>);</span>
                        <span style=color:#00a8c8>return</span><span style=color:#111>;</span>
                    <span style=color:#111>}</span>

                    <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>ToOrientation</span><span style=color:#111>(</span><span style=color:#111>pair</span><span style=color:#111>.</span><span style=color:#111>Item</span><span style=color:#111>)</span> <span style=color:#00a8c8>is</span> <span style=color:#111>not</span> <span style=color:#111>Orientation</span> <span style=color:#111>orientation</span><span style=color:#111>)</span>
                        <span style=color:#00a8c8>return</span><span style=color:#111>;</span>
                    
                    <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>maybeStartingPosition</span> <span style=color:#00a8c8>is</span> <span style=color:#111>not</span> <span style=color:#00a8c8>null</span><span style=color:#111>)</span>
                        <span style=color:#00a8c8>throw</span> <span style=color:#00a8c8>new</span> <span style=color:#111>ArgumentException</span><span style=color:#111>(</span>
                            <span style=color:#d88200>$&#34;Multiple starting positions detected at {maybeStartingPosition} and {(r, pair.Index, orientation)}&#34;</span><span style=color:#111>);</span>
                    
                    <span style=color:#111>maybeStartingPosition</span> <span style=color:#111>=</span> <span style=color:#00a8c8>new</span> <span style=color:#111>Visit</span><span style=color:#111>(</span><span style=color:#111>coordinate</span><span style=color:#111>,</span> <span style=color:#111>orientation</span><span style=color:#111>);</span>
                <span style=color:#111>});</span>
            
            <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>colsCount</span> <span style=color:#111>!=</span> <span style=color:#ae81ff>0</span> <span style=color:#111>&amp;&amp;</span> <span style=color:#111>cols</span><span style=color:#111>.</span><span style=color:#111>Count</span> <span style=color:#111>!=</span> <span style=color:#111>colsCount</span><span style=color:#111>)</span>
                <span style=color:#00a8c8>throw</span> <span style=color:#00a8c8>new</span> <span style=color:#111>ArgumentException</span><span style=color:#111>(</span><span style=color:#d88200>$&#34;Illegal grid. Found differing column counts: {colsCount} vs. {cols.Count}&#34;</span><span style=color:#111>);</span>
            
            <span style=color:#111>colsCount</span> <span style=color:#111>=</span> <span style=color:#111>cols</span><span style=color:#111>.</span><span style=color:#111>Count</span><span style=color:#111>;</span>
            <span style=color:#111>r</span><span style=color:#111>++;</span>
        <span style=color:#111>}</span>

        <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>maybeStartingPosition</span> <span style=color:#00a8c8>is</span> <span style=color:#111>not</span> <span style=color:#111>Visit</span> <span style=color:#111>startingPosition</span><span style=color:#111>)</span>
            <span style=color:#00a8c8>throw</span> <span style=color:#00a8c8>new</span> <span style=color:#111>ArgumentException</span><span style=color:#111>(</span><span style=color:#d88200>&#34;No starting position found&#34;</span><span style=color:#111>);</span>

        <span style=color:#111>StartingPosition</span> <span style=color:#111>=</span> <span style=color:#111>startingPosition</span><span style=color:#111>;</span>
        <span style=color:#111>AreaMap</span> <span style=color:#111>=</span> <span style=color:#00a8c8>new</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>colsCount</span><span style=color:#111>,</span> <span style=color:#111>obstacles</span><span style=color:#111>);</span>
    <span style=color:#111>}</span>

    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>static</span> <span style=color:#00a8c8>bool</span> <span style=color:#111>IsObstacle</span><span style=color:#111>(</span><span style=color:#00a8c8>char</span> <span style=color:#111>c</span><span style=color:#111>)</span> <span style=color:#111>=&gt;</span> <span style=color:#111>c</span> <span style=color:#111>==</span> <span style=color:#d88200>&#39;#&#39;</span><span style=color:#111>;</span>

    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>static</span> <span style=color:#111>Orientation</span><span style=color:#111>?</span> <span style=color:#111>ToOrientation</span><span style=color:#111>(</span><span style=color:#00a8c8>char</span> <span style=color:#111>c</span><span style=color:#111>)</span> <span style=color:#111>=&gt;</span> <span style=color:#111>c</span> <span style=color:#00a8c8>switch</span>
    <span style=color:#111>{</span>
        <span style=color:#d88200>&#39;^&#39;</span> <span style=color:#111>=&gt;</span> <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Up</span><span style=color:#111>,</span>
        <span style=color:#d88200>&#39;&lt;&#39;</span> <span style=color:#111>=&gt;</span> <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Left</span><span style=color:#111>,</span>
        <span style=color:#d88200>&#39;&gt;&#39;</span> <span style=color:#111>=&gt;</span> <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Right</span><span style=color:#111>,</span>
        <span style=color:#d88200>&#39;v&#39;</span> <span style=color:#111>=&gt;</span> <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Down</span><span style=color:#111>,</span>
        <span style=color:#111>_</span> <span style=color:#111>=&gt;</span> <span style=color:#00a8c8>null</span><span style=color:#111>,</span>
    <span style=color:#111>};</span>

    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>char</span> <span style=color:#111>ToCharVisualization</span><span style=color:#111>(</span><span style=color:#111>Coordinate</span> <span style=color:#111>coordinate</span><span style=color:#111>)</span>
    <span style=color:#111>{</span>
        <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>AreaMap</span><span style=color:#111>.</span><span style=color:#111>Obstacles</span><span style=color:#111>.</span><span style=color:#111>Contains</span><span style=color:#111>(</span><span style=color:#111>coordinate</span><span style=color:#111>))</span>
            <span style=color:#00a8c8>return</span> <span style=color:#d88200>&#39;#&#39;</span><span style=color:#111>;</span>
        
        <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>coordinate</span> <span style=color:#111>==</span> <span style=color:#111>StartingPosition</span><span style=color:#111>.</span><span style=color:#111>Coordinate</span><span style=color:#111>)</span>
        <span style=color:#111>{</span>
            <span style=color:#00a8c8>return</span> <span style=color:#111>StartingPosition</span><span style=color:#111>.</span><span style=color:#111>Orientation</span> <span style=color:#00a8c8>switch</span> <span style=color:#111>{</span>
                <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Up</span> <span style=color:#111>=&gt;</span> <span style=color:#d88200>&#39;^&#39;</span><span style=color:#111>,</span>
                <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Left</span> <span style=color:#111>=&gt;</span> <span style=color:#d88200>&#39;&lt;&#39;</span><span style=color:#111>,</span>
                <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Right</span> <span style=color:#111>=&gt;</span> <span style=color:#d88200>&#39;&gt;&#39;</span><span style=color:#111>,</span>
                <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Down</span> <span style=color:#111>=&gt;</span> <span style=color:#d88200>&#39;v&#39;</span><span style=color:#111>,</span>
                <span style=color:#111>_</span> <span style=color:#111>=&gt;</span> <span style=color:#00a8c8>throw</span> <span style=color:#00a8c8>new</span> <span style=color:#111>ArgumentException</span><span style=color:#111>(</span>
                    <span style=color:#d88200>$&#34;Unrecognized orientation {StartingPosition.Orientation}&#34;</span><span style=color:#111>)</span>
            <span style=color:#111>};</span>
        <span style=color:#111>}</span>

        <span style=color:#00a8c8>return</span> <span style=color:#d88200>&#39;.&#39;</span><span style=color:#111>;</span>
    <span style=color:#111>}</span>

    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>void</span> <span style=color:#111>VisualizeMapWithGuardMovement</span><span style=color:#111>(</span><span style=color:#111>HashSet</span><span style=color:#111>&lt;</span><span style=color:#111>Visit</span><span style=color:#111>&gt;</span> <span style=color:#111>visits</span><span style=color:#111>)</span>
    <span style=color:#111>{</span>
        <span style=color:#111>HashSet</span><span style=color:#111>&lt;</span><span style=color:#111>Coordinate</span><span style=color:#111>&gt;</span> <span style=color:#111>visitedCoordinates</span> <span style=color:#111>=</span> <span style=color:#111>[..</span> <span style=color:#111>visits</span><span style=color:#111>.</span><span style=color:#111>Select</span><span style=color:#111>(</span><span style=color:#111>v</span> <span style=color:#111>=&gt;</span> <span style=color:#111>v</span><span style=color:#111>.</span><span style=color:#111>Coordinate</span><span style=color:#111>)];</span>
        <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>r</span> <span style=color:#111>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>r</span> <span style=color:#111>&lt;</span> <span style=color:#111>AreaMap</span><span style=color:#111>.</span><span style=color:#111>RowCount</span><span style=color:#111>;</span> <span style=color:#111>r</span><span style=color:#111>++)</span>
        <span style=color:#111>{</span>
            <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>c</span> <span style=color:#111>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>c</span> <span style=color:#111>&lt;</span> <span style=color:#111>AreaMap</span><span style=color:#111>.</span><span style=color:#111>ColCount</span><span style=color:#111>;</span> <span style=color:#111>c</span><span style=color:#111>++)</span>
            <span style=color:#111>{</span>
                <span style=color:#111>Coordinate</span> <span style=color:#111>coordinate</span> <span style=color:#111>=</span> <span style=color:#00a8c8>new</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#111>);</span>
                <span style=color:#00a8c8>char</span> <span style=color:#111>representation</span> <span style=color:#111>=</span> <span style=color:#111>visitedCoordinates</span><span style=color:#111>.</span><span style=color:#111>Contains</span><span style=color:#111>(</span><span style=color:#111>coordinate</span><span style=color:#111>)</span>
                    <span style=color:#111>?</span> <span style=color:#d88200>&#39;X&#39;</span>
                    <span style=color:#111>:</span> <span style=color:#111>ToCharVisualization</span><span style=color:#111>(</span><span style=color:#111>coordinate</span><span style=color:#111>);</span>
                <span style=color:#111>Console</span><span style=color:#111>.</span><span style=color:#111>Write</span><span style=color:#111>(</span><span style=color:#111>representation</span><span style=color:#111>);</span>
            <span style=color:#111>}</span>
            <span style=color:#111>Console</span><span style=color:#111>.</span><span style=color:#111>WriteLine</span><span style=color:#111>();</span>
        <span style=color:#111>}</span>
    <span style=color:#111>}</span>
<span style=color:#111>}</span>
</code></pre></div></div><h2 id=part-one>Part One</h2><p>The guard follows a strict patrol protocol which involves repeatedly following
these steps:</p><ul><li>If there is something directly in front of you, turn right 90 degrees.</li><li>Otherwise, take a step forward.</li></ul><p>How many distinct positions will the guard visit before leaving the mapped area?</p><div id=GuardGallivant.PartOne.cs><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cs data-lang=cs><span style=color:#00a8c8>namespace</span> <span style=color:#111>AoC2024</span><span style=color:#111>;</span>

<span style=color:#00a8c8>public</span> <span style=color:#00a8c8>partial</span> <span style=color:#00a8c8>class</span> <span style=color:#75af00>GuardGallivant</span>
<span style=color:#111>{</span>
    <span style=color:#00a8c8>public</span> <span style=color:#00a8c8>int</span> <span style=color:#111>PartOne</span><span style=color:#111>()</span> <span style=color:#111>=&gt;</span> <span style=color:#111>SimulateGuardMovement</span><span style=color:#111>().</span><span style=color:#111>VisitedPositions</span><span style=color:#111>.</span><span style=color:#111>Count</span><span style=color:#111>();</span>

    <span style=color:#00a8c8>private</span> <span style=color:#111>(</span><span style=color:#111>IEnumerable</span><span style=color:#111>&lt;</span><span style=color:#111>Coordinate</span><span style=color:#111>&gt;</span> <span style=color:#111>VisitedPositions</span><span style=color:#111>,</span> <span style=color:#00a8c8>bool</span> <span style=color:#111>IsTrapped</span><span style=color:#111>)</span> <span style=color:#111>SimulateGuardMovement</span><span style=color:#111>()</span>
    <span style=color:#111>{</span>
        <span style=color:#111>HashSet</span><span style=color:#111>&lt;</span><span style=color:#111>Visit</span><span style=color:#111>&gt;</span> <span style=color:#111>visits</span> <span style=color:#111>=</span> <span style=color:#111>[</span><span style=color:#111>StartingPosition</span><span style=color:#111>];</span>
        <span style=color:#00a8c8>var</span> <span style=color:#111>orientation</span> <span style=color:#111>=</span> <span style=color:#111>StartingPosition</span><span style=color:#111>.</span><span style=color:#111>Orientation</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>var</span> <span style=color:#111>(</span><span style=color:#111>dr</span><span style=color:#111>,</span> <span style=color:#111>dc</span><span style=color:#111>)</span> <span style=color:#111>=</span> <span style=color:#111>ToVector</span><span style=color:#111>(</span><span style=color:#111>orientation</span><span style=color:#111>);</span>
        <span style=color:#00a8c8>var</span> <span style=color:#111>nr</span> <span style=color:#111>=</span> <span style=color:#111>StartingPosition</span><span style=color:#111>.</span><span style=color:#111>Coordinate</span><span style=color:#111>.</span><span style=color:#111>R</span> <span style=color:#111>+</span> <span style=color:#111>dr</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>var</span> <span style=color:#111>nc</span> <span style=color:#111>=</span> <span style=color:#111>StartingPosition</span><span style=color:#111>.</span><span style=color:#111>Coordinate</span><span style=color:#111>.</span><span style=color:#111>C</span> <span style=color:#111>+</span> <span style=color:#111>dc</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>var</span> <span style=color:#111>isTrapped</span> <span style=color:#111>=</span> <span style=color:#00a8c8>false</span><span style=color:#111>;</span>

        <span style=color:#00a8c8>while</span> <span style=color:#111>(</span><span style=color:#111>InBounds</span><span style=color:#111>(</span><span style=color:#111>nr</span><span style=color:#111>,</span> <span style=color:#111>nc</span><span style=color:#111>))</span>
        <span style=color:#111>{</span>
            <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>AreaMap</span><span style=color:#111>.</span><span style=color:#111>Obstacles</span><span style=color:#111>.</span><span style=color:#111>Contains</span><span style=color:#111>(</span><span style=color:#00a8c8>new</span><span style=color:#111>(</span><span style=color:#111>nr</span><span style=color:#111>,</span> <span style=color:#111>nc</span><span style=color:#111>)))</span>
            <span style=color:#111>{</span>
                <span style=color:#111>(</span><span style=color:#111>nr</span><span style=color:#111>,</span> <span style=color:#111>nc</span><span style=color:#111>)</span> <span style=color:#111>=</span> <span style=color:#111>(</span><span style=color:#111>nr</span> <span style=color:#111>-</span> <span style=color:#111>dr</span><span style=color:#111>,</span> <span style=color:#111>nc</span> <span style=color:#111>-</span> <span style=color:#111>dc</span><span style=color:#111>);</span>
                <span style=color:#111>orientation</span> <span style=color:#111>=</span> <span style=color:#111>TurnRight90Degrees</span><span style=color:#111>(</span><span style=color:#111>orientation</span><span style=color:#111>);</span>
                <span style=color:#111>(</span><span style=color:#111>dr</span><span style=color:#111>,</span> <span style=color:#111>dc</span><span style=color:#111>)</span> <span style=color:#111>=</span> <span style=color:#111>ToVector</span><span style=color:#111>(</span><span style=color:#111>orientation</span><span style=color:#111>);</span>
                <span style=color:#00a8c8>continue</span><span style=color:#111>;</span>
            <span style=color:#111>}</span>

            <span style=color:#111>Visit</span> <span style=color:#111>visit</span> <span style=color:#111>=</span> <span style=color:#00a8c8>new</span><span style=color:#111>(</span><span style=color:#00a8c8>new</span><span style=color:#111>(</span><span style=color:#111>nr</span><span style=color:#111>,</span> <span style=color:#111>nc</span><span style=color:#111>),</span> <span style=color:#111>orientation</span><span style=color:#111>);</span>

            <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>visits</span><span style=color:#111>.</span><span style=color:#111>Contains</span><span style=color:#111>(</span><span style=color:#111>visit</span><span style=color:#111>))</span>
            <span style=color:#111>{</span>
                <span style=color:#111>isTrapped</span> <span style=color:#111>=</span> <span style=color:#00a8c8>true</span><span style=color:#111>;</span>
                <span style=color:#00a8c8>break</span><span style=color:#111>;</span>
            <span style=color:#111>}</span>
            
            <span style=color:#111>visits</span><span style=color:#111>.</span><span style=color:#111>Add</span><span style=color:#111>(</span><span style=color:#111>visit</span><span style=color:#111>);</span>

            <span style=color:#111>(</span><span style=color:#111>nr</span><span style=color:#111>,</span> <span style=color:#111>nc</span><span style=color:#111>)</span> <span style=color:#111>=</span> <span style=color:#111>(</span><span style=color:#111>nr</span> <span style=color:#111>+</span> <span style=color:#111>dr</span><span style=color:#111>,</span> <span style=color:#111>nc</span> <span style=color:#111>+</span> <span style=color:#111>dc</span><span style=color:#111>);</span>
        <span style=color:#111>}</span>

        <span style=color:#75715e>// VisualizeMapWithGuardMovement(visits);
</span><span style=color:#75715e></span>
        <span style=color:#00a8c8>return</span> <span style=color:#111>(</span>
            <span style=color:#111>visits</span><span style=color:#111>.</span><span style=color:#111>GroupBy</span><span style=color:#111>(</span><span style=color:#111>visit</span> <span style=color:#111>=&gt;</span> <span style=color:#111>visit</span><span style=color:#111>.</span><span style=color:#111>Coordinate</span><span style=color:#111>).</span><span style=color:#111>Select</span><span style=color:#111>(</span><span style=color:#111>g</span> <span style=color:#111>=&gt;</span> <span style=color:#111>g</span><span style=color:#111>.</span><span style=color:#111>Key</span><span style=color:#111>),</span>
            <span style=color:#111>isTrapped</span><span style=color:#111>);</span>
    <span style=color:#111>}</span>

    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>static</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>dr</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>dc</span><span style=color:#111>)</span> <span style=color:#111>ToVector</span><span style=color:#111>(</span><span style=color:#111>Orientation</span> <span style=color:#111>orientation</span><span style=color:#111>)</span> <span style=color:#111>=&gt;</span> <span style=color:#111>orientation</span> <span style=color:#00a8c8>switch</span> <span style=color:#111>{</span>
        <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Up</span> <span style=color:#111>=&gt;</span> <span style=color:#111>(-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>),</span>
        <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Left</span> <span style=color:#111>=&gt;</span> <span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#111>-</span><span style=color:#ae81ff>1</span><span style=color:#111>),</span>
        <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Right</span> <span style=color:#111>=&gt;</span> <span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>1</span><span style=color:#111>),</span>
        <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Down</span> <span style=color:#111>=&gt;</span> <span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>),</span>
        <span style=color:#111>_</span> <span style=color:#111>=&gt;</span> <span style=color:#00a8c8>throw</span> <span style=color:#00a8c8>new</span> <span style=color:#111>ArgumentException</span><span style=color:#111>(</span><span style=color:#d88200>$&#34;Unrecognized input: {orientation}&#34;</span><span style=color:#111>)</span>
    <span style=color:#111>};</span>

    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>static</span> <span style=color:#111>Orientation</span> <span style=color:#111>TurnRight90Degrees</span><span style=color:#111>(</span><span style=color:#111>Orientation</span> <span style=color:#111>orientation</span><span style=color:#111>)</span> <span style=color:#111>=&gt;</span> <span style=color:#111>orientation</span> <span style=color:#00a8c8>switch</span> <span style=color:#111>{</span>
        <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Up</span> <span style=color:#111>=&gt;</span> <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Right</span><span style=color:#111>,</span>
        <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Right</span> <span style=color:#111>=&gt;</span> <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Down</span><span style=color:#111>,</span>
        <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Down</span> <span style=color:#111>=&gt;</span> <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Left</span><span style=color:#111>,</span>
        <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Left</span> <span style=color:#111>=&gt;</span> <span style=color:#111>Orientation</span><span style=color:#111>.</span><span style=color:#111>Up</span><span style=color:#111>,</span>
        <span style=color:#111>_</span> <span style=color:#111>=&gt;</span> <span style=color:#00a8c8>throw</span> <span style=color:#00a8c8>new</span> <span style=color:#111>ArgumentException</span><span style=color:#111>(</span><span style=color:#d88200>&#34;Invalid direction vector&#34;</span><span style=color:#111>)</span>
    <span style=color:#111>};</span>

    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>bool</span> <span style=color:#111>InBounds</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>r</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>c</span><span style=color:#111>)</span> <span style=color:#111>=&gt;</span>
        <span style=color:#111>r</span> <span style=color:#111>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#111>&amp;&amp;</span> <span style=color:#111>r</span> <span style=color:#111>&lt;</span> <span style=color:#111>AreaMap</span><span style=color:#111>.</span><span style=color:#111>RowCount</span> <span style=color:#111>&amp;&amp;</span> <span style=color:#111>c</span> <span style=color:#111>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#111>&amp;&amp;</span> <span style=color:#111>c</span> <span style=color:#111>&lt;</span> <span style=color:#111>AreaMap</span><span style=color:#111>.</span><span style=color:#111>ColCount</span><span style=color:#111>;</span>
<span style=color:#111>}</span>
</code></pre></div></div><h2 id=part-two>Part Two</h2><p>How many different positions can you choose for adding a new obstruction that
gets the guard stuck in a loop? The new obstruction can&rsquo;t be placed at the
guard&rsquo;s starting position.</p><div id=GuardGallivant.PartTwo.cs><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cs data-lang=cs><span style=color:#00a8c8>namespace</span> <span style=color:#111>AoC2024</span><span style=color:#111>;</span>

<span style=color:#00a8c8>public</span> <span style=color:#00a8c8>partial</span> <span style=color:#00a8c8>class</span> <span style=color:#75af00>GuardGallivant</span>
<span style=color:#111>{</span>
    <span style=color:#00a8c8>public</span> <span style=color:#00a8c8>int</span> <span style=color:#111>PartTwo</span><span style=color:#111>()</span> <span style=color:#111>{</span>
        <span style=color:#00a8c8>var</span> <span style=color:#111>(</span><span style=color:#111>visitedPositions</span><span style=color:#111>,</span> <span style=color:#111>isTrapped</span><span style=color:#111>)</span> <span style=color:#111>=</span> <span style=color:#111>SimulateGuardMovement</span><span style=color:#111>();</span>

        <span style=color:#00a8c8>return</span> <span style=color:#111>visitedPositions</span>
            <span style=color:#111>.</span><span style=color:#111>Where</span><span style=color:#111>(</span><span style=color:#111>position</span> <span style=color:#111>=&gt;</span> <span style=color:#111>position</span> <span style=color:#111>!=</span> <span style=color:#111>StartingPosition</span><span style=color:#111>.</span><span style=color:#111>Coordinate</span><span style=color:#111>)</span>
            <span style=color:#111>.</span><span style=color:#111>Aggregate</span><span style=color:#111>(</span>
                <span style=color:#111>isTrapped</span> <span style=color:#111>?</span> <span style=color:#ae81ff>1</span> <span style=color:#111>:</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span>
                <span style=color:#111>(</span><span style=color:#111>sum</span><span style=color:#111>,</span> <span style=color:#111>coordinate</span><span style=color:#111>)</span> <span style=color:#111>=&gt;</span>
                    <span style=color:#111>sum</span> <span style=color:#111>+</span> <span style=color:#111>(</span><span style=color:#111>IsGuardTrappedByAdditionalObstacle</span><span style=color:#111>(</span><span style=color:#111>coordinate</span><span style=color:#111>)</span> <span style=color:#111>?</span> <span style=color:#ae81ff>1</span> <span style=color:#111>:</span> <span style=color:#ae81ff>0</span><span style=color:#111>));</span>
    <span style=color:#111>}</span>

    <span style=color:#00a8c8>private</span> <span style=color:#00a8c8>bool</span> <span style=color:#111>IsGuardTrappedByAdditionalObstacle</span><span style=color:#111>(</span><span style=color:#111>Coordinate</span> <span style=color:#111>coordinate</span><span style=color:#111>)</span>
    <span style=color:#111>{</span>
        <span style=color:#111>AreaMap</span><span style=color:#111>.</span><span style=color:#111>Obstacles</span><span style=color:#111>.</span><span style=color:#111>Add</span><span style=color:#111>(</span><span style=color:#111>coordinate</span><span style=color:#111>);</span>
        <span style=color:#00a8c8>var</span> <span style=color:#111>isTrapped</span> <span style=color:#111>=</span> <span style=color:#111>SimulateGuardMovement</span><span style=color:#111>().</span><span style=color:#111>IsTrapped</span><span style=color:#111>;</span>
        <span style=color:#111>AreaMap</span><span style=color:#111>.</span><span style=color:#111>Obstacles</span><span style=color:#111>.</span><span style=color:#111>Remove</span><span style=color:#111>(</span><span style=color:#111>coordinate</span><span style=color:#111>);</span>
        <span style=color:#00a8c8>return</span> <span style=color:#111>isTrapped</span><span style=color:#111>;</span>
    <span style=color:#111>}</span>
<span style=color:#111>}</span>
</code></pre></div></div><p>The performance of this step is noteworthy. At first, I used <code>PositionState[,]</code>,
a 2D array, to represent the area map. I solved by creating a new 2D array with
a new obstacle at \((r, c)\) slotted in. This copied a lot of data around, and
the test took 20s to run. <span class=citation-ref><a href=#programming_challenges-56c85e9></a></span>moved from
<code>PositionState[,]</code> to <code>(int RowCount, int ColCount, HashSet&lt;Coordinate> Obstacles) AreaMap</code>, which is a more memory efficient representation. To solve
part 2, I mutated <code>HashSet&lt;Coordinate> Obstacles</code> in place, but that took 25s to
run! Aha, no need to place obstacles at locations where the guard will never
visit; that takes the runtime down from 25s to 3s! Hindsight is 20/20.</p><h2 id=reference>Reference</h2><ol><li><div class=citation citation-icon-class="fas fa-fw fa-globe" cited-by-count is-main><cite id=AoC2024Day06>Day 06 - Advent of Code 2024: Guard Gallivant<i>.</i></cite>
Eric Wastl.
<a href=https://adventofcode.com/2024/day/6 target=_blank rel=noopener><img src="https://www.google.com/s2/favicons?domain=adventofcode.com" loading=lazy aria-hidden=true width=16 height=16>
<i>adventofcode.com</i> <i class="fas fa-fw fa-external-link-alt" aria-hidden=true></i></a>.
<i class="fas fa-fw fa-globe" aria-hidden=true></i>Accessed Aug 23, 2025.</div></li><li><div class=citation citation-icon-class="fas fa-fw fa-globe" cited-by-count is-main><cite id=programming_challenges-56c85e9>[AoC 2024] [Guard Gallivant] Use sparse representation of map · dchege711/programming_challenges@56c85e9<i>.</i></cite>
<a href=https://github.com/dchege711/programming_challenges/commit/56c85e9ae0ca04f40b3155a83086dd8953694cba#diff-93422f2e2791d2fc730af4949784390b98b88acc23648e9e0c4751e416eda913 target=_blank rel=noopener><img src="https://www.google.com/s2/favicons?domain=github.com" loading=lazy aria-hidden=true width=16 height=16>
<i>github.com</i> <i class="fas fa-fw fa-external-link-alt" aria-hidden=true></i></a>.
Sep 11, 2025.
<i class="fas fa-fw fa-globe" aria-hidden=true></i>Accessed Sep 11, 2025.</div></li></ol></article><div style=font-size:smaller><aside id=authors-holder style="margin:0 0 2%">Cited Authors:
<a href=/cited-authors/Wastl-Eric>Wastl, Eric</a></aside><aside id=domains-holder style="margin:0 0 2%">Cited Domains:
<a href=/domains/adventofcode.com style="margin:0 2px"><img src="https://www.google.com/s2/favicons?domain=adventofcode.com" loading=lazy aria-hidden=true width=16 height=16>
adventofcode.com</a>
<a href=/domains/github.com style="margin:0 2px"><img src="https://www.google.com/s2/favicons?domain=github.com" loading=lazy aria-hidden=true width=16 height=16>
github.com</a></aside></div></div><footer><a href=https://www.curiosities.dev/computer-science/programming-challenges/advent-of-code/2024/AoC2024/05-print-queue/05-print-queue/>&#171; AoC 2024 Day 05: Print Queue</a>
<a href=https://www.curiosities.dev/computer-science/programming-challenges/advent-of-code/2024/AoC2024/07-bridge-repair/07-bridge-repair/>AoC 2024 Day 07: Bridge Repair &#187;</a></footer></section></div><footer><a href=/about>About</a>
<a href=/search>Search</a></footer></body></html>